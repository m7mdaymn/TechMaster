import{d as A,g as T,m as k,n as U,o as $,t as B}from"./chunk-HRUO5R4Q.js";import{a as D}from"./chunk-JLLNXAHD.js";import{d as R}from"./chunk-L2ZR2CCC.js";import{Ab as n,Bb as c,Cb as h,Fb as E,Gb as S,Hb as P,Jb as w,Mb as p,Na as o,Nb as g,W as y,Y as M,db as x,jb as f,jc as O,kb as v,lb as e,mb as t,mc as I,nb as b,sb as _}from"./chunk-Q5RFH5SI.js";var z=(s,d)=>d.label,L=(s,d)=>d.id,j=(s,d)=>d.name;function F(s,d){if(s&1&&(e(0,"div",27),b(1,"div",37),e(2,"span",38),n(3),t()()),s&2){let r=d.$implicit;o(),x("height",r.value,"%"),o(2),c(r.label)}}function G(s,d){if(s&1&&(e(0,"div",27),b(1,"div",39),e(2,"span",38),n(3),t()()),s&2){let r=d.$implicit;o(),x("height",r.value,"%"),o(2),c(r.label)}}function N(s,d){if(s&1&&(e(0,"tr")(1,"td"),n(2),t(),e(3,"td")(4,"div",40)(5,"span",41),n(6),t(),e(7,"span",42),n(8),t()()(),e(9,"td"),n(10),p(11,"number"),t(),e(12,"td"),n(13),p(14,"number"),t(),e(15,"td")(16,"span",43),n(17),t()()()),s&2){let r=d.$implicit,i=d.$index;o(2),c(i+1),o(4),c(r.title),o(2),c(r.category),o(2),c(g(11,6,r.enrollments)),o(3),h("$",g(14,8,r.revenue),""),o(4),h(" \u2B50 ",r.rating," ")}}function W(s,d){if(s&1&&(e(0,"div",33)(1,"span",44),n(2),t(),e(3,"div",45)(4,"span",46),n(5),t(),e(6,"span",47),n(7),t()()()),s&2){let r=d.$implicit;o(2),c(r.icon),o(3),c(r.text),o(2),c(r.time)}}function V(s,d){if(s&1&&(e(0,"div",36)(1,"div",48)(2,"span",49),n(3),t(),e(4,"span",50),n(5),p(6,"number"),t()(),e(7,"div",51),b(8,"div",52),t()()),s&2){let r=d.$implicit;o(3),c(r.name),o(2),c(g(6,4,r.count)),o(3),x("width",r.percentage,"%")}}var te=(()=>{class s{http=y(R);apiUrl=D.apiUrl;selectedPeriod="30";isLoading=!1;totalUsers=0;totalStudents=0;totalInstructors=0;userGrowth=0;totalRevenue=0;revenueGrowth=8;activeCourses=0;publishedCourses=0;totalEnrollments=0;completedEnrollments=0;pendingEnrollments=0;completionRate=0;certificatesIssued=0;totalInternships=0;pendingApplications=0;totalContactMessages=0;unreadMessages=0;userChartData=[];enrollmentChartData=[];topCourses=[];recentActivities=[];categoryBreakdown=[];ngOnInit(){this.loadReports()}loadReports(){this.isLoading=!0,this.http.get(`${this.apiUrl}/dashboard/admin?period=${this.selectedPeriod}`).subscribe({next:r=>{if(r.isSuccess&&r.data){let i=r.data;if(this.totalUsers=(i.totalStudents||0)+(i.totalInstructors||0),this.totalStudents=i.totalStudents||0,this.totalInstructors=i.totalInstructors||0,this.activeCourses=i.totalCourses||0,this.publishedCourses=i.publishedCourses||0,this.totalEnrollments=i.totalEnrollments||0,this.completedEnrollments=i.completedEnrollments||0,this.pendingEnrollments=i.pendingEnrollments||0,this.certificatesIssued=i.totalCertificates||0,this.totalRevenue=i.totalRevenue||0,this.totalInternships=i.totalInternships||0,this.pendingApplications=i.pendingApplications||0,this.totalContactMessages=i.totalContactMessages||0,this.unreadMessages=i.unreadMessages||0,this.completionRate=this.totalEnrollments>0?Math.round(this.completedEnrollments/this.totalEnrollments*100):0,i.userRegistrationStats&&i.userRegistrationStats.length>0){let a=Math.max(...i.userRegistrationStats.map(l=>l.count));this.userChartData=i.userRegistrationStats.map(l=>({label:l.period.split(" ")[0],value:a>0?l.count/a*100:0}))}if(this.userGrowth=Math.round(i.userGrowthPercentage||0),this.revenueGrowth=Math.round(i.revenueGrowthPercentage||0),i.enrollmentStats&&i.enrollmentStats.length>0){let a=Math.max(...i.enrollmentStats.map(l=>l.count));this.enrollmentChartData=i.enrollmentStats.map(l=>({label:l.period.split(" ")[0],value:a>0?l.count/a*100:0}))}i.categoryBreakdown&&i.categoryBreakdown.length>0&&(this.categoryBreakdown=i.categoryBreakdown.map(a=>({name:a.name,count:a.count,percentage:a.percentage}))),i.topCourses&&i.topCourses.length>0&&(this.topCourses=i.topCourses.map(a=>({id:a.courseId,title:a.courseName,category:"Course",enrollments:a.enrollmentCount,revenue:a.enrollmentCount*50,rating:4.5}))),i.recentActivities&&i.recentActivities.length>0&&(this.recentActivities=i.recentActivities.map((a,l)=>({id:l+1,icon:a.type==="Enrollment"?"\u{1F4DA}":"\u{1F464}",text:a.description,time:this.getRelativeTime(a.timestamp)})))}this.isLoading=!1},error:()=>{this.isLoading=!1,this.loadSampleData()}})}getRelativeTime(r){let i=new Date,a=new Date(r),l=i.getTime()-a.getTime(),m=Math.floor(l/6e4);if(m<60)return`${m} minutes ago`;let u=Math.floor(m/60);return u<24?`${u} hours ago`:`${Math.floor(u/24)} days ago`}loadSampleData(){this.topCourses=[{id:1,title:"Web Development Bootcamp",category:"Development",enrollments:523,revenue:12575,rating:4.8},{id:2,title:"Data Science Fundamentals",category:"Data Science",enrollments:412,revenue:10300,rating:4.7},{id:3,title:"UI/UX Design Masterclass",category:"Design",enrollments:356,revenue:8900,rating:4.9},{id:4,title:"Cloud Computing Essentials",category:"Cloud",enrollments:298,revenue:7450,rating:4.6},{id:5,title:"Mobile App Development",category:"Development",enrollments:267,revenue:6675,rating:4.5}],this.recentActivities=[{id:1,icon:"\u{1F464}",text:"New user registered: Ahmed H.",time:"5 minutes ago"},{id:2,icon:"\u{1F4DA}",text:"Course enrolled: Web Development",time:"12 minutes ago"},{id:3,icon:"\u{1F393}",text:"Certificate issued to Sara M.",time:"25 minutes ago"},{id:4,icon:"\u{1F4AC}",text:"New testimonial received",time:"1 hour ago"},{id:5,icon:"\u2B50",text:"Course rated 5 stars",time:"2 hours ago"}],this.categoryBreakdown=[{name:"Web Development",count:1245,percentage:85},{name:"Data Science",count:892,percentage:65},{name:"UI/UX Design",count:654,percentage:50},{name:"Cloud Computing",count:523,percentage:40},{name:"Mobile Development",count:412,percentage:32},{name:"Cybersecurity",count:298,percentage:25}]}exportReport(){let r=["Category","Metric","Value"],i=[["Users","Total Users",this.totalUsers],["Users","Total Students",this.totalStudents],["Users","Total Instructors",this.totalInstructors],["Users","User Growth %",`${this.userGrowth}%`],["Courses","Total Courses",this.activeCourses],["Courses","Published Courses",this.publishedCourses],["Enrollments","Total Enrollments",this.totalEnrollments],["Enrollments","Completed Enrollments",this.completedEnrollments],["Enrollments","Pending Enrollments",this.pendingEnrollments],["Enrollments","Completion Rate",`${this.completionRate}%`],["Revenue","Total Revenue",`$${this.totalRevenue}`],["Certificates","Certificates Issued",this.certificatesIssued],["Internships","Total Internships",this.totalInternships],["Internships","Pending Applications",this.pendingApplications],["Messages","Total Contact Messages",this.totalContactMessages],["Messages","Unread Messages",this.unreadMessages]];this.topCourses.length>0&&(i.push(["","",""]),i.push(["Top Courses","Course Name","Enrollments"]),this.topCourses.forEach(C=>{i.push(["",C.title,C.enrollments])}));let a=[r.join(","),...i.map(C=>C.join(","))].join(`
`),l=new Blob([a],{type:"text/csv"}),m=window.URL.createObjectURL(l),u=document.createElement("a");u.href=m,u.download=`techmaster-report-${new Date().toISOString().split("T")[0]}.csv`,u.click(),window.URL.revokeObjectURL(m)}static \u0275fac=function(i){return new(i||s)};static \u0275cmp=M({type:s,selectors:[["app-admin-reports"]],standalone:!0,features:[w],decls:121,vars:17,consts:[[1,"reports-page"],[1,"page-header"],[1,"header-left"],[1,"subtitle"],[1,"header-actions"],[3,"ngModelChange","ngModel"],["value","7"],["value","30"],["value","90"],["value","365"],[1,"export-btn",3,"click"],[1,"stats-row"],[1,"stat-card","growth"],[1,"stat-header"],[1,"stat-icon"],[1,"stat-trend","positive"],[1,"stat-body"],[1,"stat-value"],[1,"stat-label"],[1,"stat-card","revenue"],[1,"stat-card","courses"],[1,"stat-trend"],[1,"stat-card","completion"],[1,"charts-section"],[1,"chart-card"],[1,"chart-placeholder"],[1,"bar-chart"],[1,"bar-item"],[1,"tables-section"],[1,"table-card"],[1,"table-header"],[1,"view-all-btn"],[1,"activity-list"],[1,"activity-item"],[1,"category-section"],[1,"category-list"],[1,"category-item"],[1,"bar"],[1,"bar-label"],[1,"bar","enrollment-bar"],[1,"course-cell"],[1,"course-title"],[1,"course-category"],[1,"rating"],[1,"activity-icon"],[1,"activity-info"],[1,"activity-text"],[1,"activity-time"],[1,"category-header"],[1,"category-name"],[1,"category-count"],[1,"category-bar-bg"],[1,"category-bar"]],template:function(i,a){i&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),n(4,"Reports & Analytics"),t(),e(5,"p",3),n(6,"View platform statistics and performance metrics"),t()(),e(7,"div",4)(8,"select",5),P("ngModelChange",function(m){return S(a.selectedPeriod,m)||(a.selectedPeriod=m),m}),_("ngModelChange",function(){return a.loadReports()}),e(9,"option",6),n(10,"Last 7 days"),t(),e(11,"option",7),n(12,"Last 30 days"),t(),e(13,"option",8),n(14,"Last 3 months"),t(),e(15,"option",9),n(16,"Last year"),t()(),e(17,"button",10),_("click",function(){return a.exportReport()}),n(18," \u{1F4CA} Export Report "),t()()(),e(19,"div",11)(20,"div",12)(21,"div",13)(22,"span",14),n(23,"\u{1F465}"),t(),e(24,"span",15),n(25),t()(),e(26,"div",16)(27,"span",17),n(28),p(29,"number"),t(),e(30,"span",18),n(31,"Total Users"),t()()(),e(32,"div",19)(33,"div",13)(34,"span",14),n(35,"\u{1F4B0}"),t(),e(36,"span",15),n(37),t()(),e(38,"div",16)(39,"span",17),n(40),p(41,"number"),t(),e(42,"span",18),n(43,"Total Revenue"),t()()(),e(44,"div",20)(45,"div",13)(46,"span",14),n(47,"\u{1F4DA}"),t(),e(48,"span",21),n(49),t()(),e(50,"div",16)(51,"span",17),n(52),p(53,"number"),t(),e(54,"span",18),n(55,"Total Enrollments"),t()()(),e(56,"div",22)(57,"div",13)(58,"span",14),n(59,"\u{1F393}"),t(),e(60,"span",21),n(61),t()(),e(62,"div",16)(63,"span",17),n(64),p(65,"number"),t(),e(66,"span",18),n(67,"Certificates Issued"),t()()()(),e(68,"div",23)(69,"div",24)(70,"h3"),n(71,"User Registrations"),t(),e(72,"div",25)(73,"div",26),f(74,F,4,3,"div",27,z),t()()(),e(76,"div",24)(77,"h3"),n(78,"Enrollment Trends"),t(),e(79,"div",25)(80,"div",26),f(81,G,4,3,"div",27,z),t()()()(),e(83,"div",28)(84,"div",29)(85,"div",30)(86,"h3"),n(87,"Top Courses"),t(),e(88,"button",31),n(89,"View All"),t()(),e(90,"table")(91,"thead")(92,"tr")(93,"th"),n(94,"#"),t(),e(95,"th"),n(96,"Course"),t(),e(97,"th"),n(98,"Enrollments"),t(),e(99,"th"),n(100,"Revenue"),t(),e(101,"th"),n(102,"Rating"),t()()(),e(103,"tbody"),f(104,N,18,10,"tr",null,L),t()()(),e(106,"div",29)(107,"div",30)(108,"h3"),n(109,"Recent Activity"),t(),e(110,"button",31),n(111,"View All"),t()(),e(112,"div",32),f(113,W,8,3,"div",33,L),t()()(),e(115,"div",34)(116,"h3"),n(117,"Enrollment by Category"),t(),e(118,"div",35),f(119,V,9,6,"div",36,j),t()()()),i&2&&(o(8),E("ngModel",a.selectedPeriod),o(17),h("+",a.userGrowth,"%"),o(3),c(g(29,9,a.totalUsers)),o(9),h("+",a.revenueGrowth,"%"),o(3),h("$",g(41,11,a.totalRevenue),""),o(9),c(a.activeCourses),o(3),c(g(53,13,a.totalEnrollments)),o(9),h("",a.completionRate,"%"),o(3),c(g(65,15,a.certificatesIssued)),o(10),v(a.userChartData),o(7),v(a.enrollmentChartData),o(23),v(a.topCourses),o(9),v(a.recentActivities),o(6),v(a.categoryBreakdown))},dependencies:[I,O,B,U,$,k,A,T],styles:[".reports-page[_ngcontent-%COMP%]{padding:2rem;max-width:1400px;margin:0 auto}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:2rem}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;margin-bottom:.25rem}.subtitle[_ngcontent-%COMP%]{color:#666}.header-actions[_ngcontent-%COMP%]{display:flex;gap:1rem}.header-actions[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.75rem 1rem;border:2px solid #e0e0e0;border-radius:8px;font-size:.95rem;cursor:pointer}.export-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.75rem 1.5rem;background:#247090;color:#fff;border:none;border-radius:8px;font-weight:600;cursor:pointer}.export-btn[_ngcontent-%COMP%]:hover{background:#1a5570}.stats-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:1.5rem;margin-bottom:2rem}.stat-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:1.5rem;box-shadow:0 4px 20px #00000014}.stat-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.stat-icon[_ngcontent-%COMP%]{font-size:1.5rem}.stat-trend[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:20px;font-size:.85rem;font-weight:600;background:#f0f0f0}.stat-trend.positive[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.stat-body[_ngcontent-%COMP%]{display:flex;flex-direction:column}.stat-value[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;margin-bottom:.25rem}.stat-label[_ngcontent-%COMP%]{color:#666}.charts-section[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1.5rem;margin-bottom:2rem}.chart-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:1.5rem;box-shadow:0 4px 20px #00000014}.chart-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;margin-bottom:1rem}.chart-placeholder[_ngcontent-%COMP%]{height:200px;display:flex;align-items:flex-end;padding:1rem 0}.bar-chart[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:flex-end;justify-content:space-around;gap:.5rem}.bar-item[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;height:100%;justify-content:flex-end}.bar[_ngcontent-%COMP%]{width:100%;max-width:40px;background:linear-gradient(180deg,#247090,#1a5570);border-radius:4px 4px 0 0;transition:height .5s ease}.bar.enrollment-bar[_ngcontent-%COMP%]{background:linear-gradient(180deg,#4caf50,#2e7d32)}.bar-label[_ngcontent-%COMP%]{font-size:.75rem;color:#666;margin-top:.5rem}.tables-section[_ngcontent-%COMP%]{display:grid;grid-template-columns:3fr 2fr;gap:1.5rem;margin-bottom:2rem}.table-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:1.5rem;box-shadow:0 4px 20px #00000014}.table-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.table-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600}.view-all-btn[_ngcontent-%COMP%]{color:#247090;background:none;border:none;font-weight:600;cursor:pointer}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%]{text-align:left;padding:.75rem;font-weight:600;font-size:.85rem;color:#666;border-bottom:2px solid #f0f0f0}td[_ngcontent-%COMP%]{padding:.75rem;border-bottom:1px solid #f0f0f0}.course-cell[_ngcontent-%COMP%]{display:flex;flex-direction:column}.course-title[_ngcontent-%COMP%]{font-weight:500}.course-category[_ngcontent-%COMP%]{font-size:.8rem;color:#666}.rating[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.25rem}.activity-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.activity-item[_ngcontent-%COMP%]{display:flex;gap:1rem;padding:.75rem;background:#f8f9fa;border-radius:8px}.activity-icon[_ngcontent-%COMP%]{font-size:1.25rem}.activity-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.activity-text[_ngcontent-%COMP%]{font-size:.9rem}.activity-time[_ngcontent-%COMP%]{font-size:.8rem;color:#999}.category-section[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:1.5rem;box-shadow:0 4px 20px #00000014}.category-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;margin-bottom:1.5rem}.category-list[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1.5rem}.category-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.category-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.category-name[_ngcontent-%COMP%]{font-weight:500}.category-count[_ngcontent-%COMP%]{color:#666}.category-bar-bg[_ngcontent-%COMP%]{height:8px;background:#f0f0f0;border-radius:4px;overflow:hidden}.category-bar[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#247090,#4caf50);border-radius:4px;transition:width .5s ease}@media (max-width: 1024px){.stats-row[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.charts-section[_ngcontent-%COMP%], .tables-section[_ngcontent-%COMP%]{grid-template-columns:1fr}}@media (max-width: 768px){.page-header[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.header-actions[_ngcontent-%COMP%]{width:100%;flex-wrap:wrap}.category-list[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})}return s})();export{te as AdminReportsComponent};
