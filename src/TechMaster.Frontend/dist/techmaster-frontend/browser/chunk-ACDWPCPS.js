import{b as I,d as R}from"./chunk-KRVVGRJQ.js";import{a as U}from"./chunk-G35OTEPF.js";import{b as L,d as Q,g as W,t as B}from"./chunk-HRUO5R4Q.js";import{a as $}from"./chunk-QFQZ7TF5.js";import"./chunk-XAZLOLJU.js";import"./chunk-JLLNXAHD.js";import"./chunk-AJDLSE77.js";import"./chunk-L2ZR2CCC.js";import{$a as h,Ab as o,Bb as g,Cb as x,Db as A,Fb as v,Gb as M,Hb as P,Jb as F,Mb as O,Na as a,Nb as D,Ob as V,W as _,Wa as b,Y as k,fb as S,ga as u,gb as C,ha as m,ic as T,jb as y,jc as j,kb as E,lb as n,mb as i,mc as z,qb as f,sb as d,tb as c}from"./chunk-Q5RFH5SI.js";var N=(s,p)=>p.id;function q(s,p){s&1&&(n(0,"span",28),o(1,"Free"),i())}function G(s,p){if(s&1&&(n(0,"span"),o(1),i()),s&2){let e=c().$implicit;a(),x("",e.price," EGP")}}function Y(s,p){if(s&1){let e=f();n(0,"button",35),d("click",function(){u(e);let t=c().$implicit,l=c();return m(l.approveCourse(t))}),o(1,"\u2705"),i(),n(2,"button",36),d("click",function(){u(e);let t=c().$implicit,l=c();return m(l.rejectCourse(t))}),o(3,"\u274C"),i()}}function H(s,p){if(s&1){let e=f();n(0,"button",37),d("click",function(){u(e);let t=c().$implicit,l=c();return m(l.archiveCourse(t))}),o(1,"\u{1F4E6}"),i()}}function J(s,p){if(s&1){let e=f();n(0,"button",38),d("click",function(){u(e);let t=c().$implicit,l=c();return m(l.republishCourse(t))}),o(1,"\u{1F680}"),i()}}function K(s,p){if(s&1){let e=f();n(0,"tr")(1,"td")(2,"div",22)(3,"div",23)(4,"span",24),o(5),i(),n(6,"span",25),o(7),O(8,"date"),i()()()(),n(9,"td"),o(10),i(),n(11,"td")(12,"span",26),o(13),i()(),n(14,"td")(15,"span",27),o(16),i()(),n(17,"td"),h(18,q,2,0,"span",28)(19,G,2,1,"span"),i(),n(20,"td"),o(21),O(22,"number"),i(),n(23,"td")(24,"div",29)(25,"button",30),d("click",function(){let t=u(e).$implicit,l=c();return m(l.viewCourse(t))}),o(26,"\u{1F441}\uFE0F"),i(),h(27,Y,4,0)(28,H,2,0,"button",31)(29,J,2,0,"button",32),n(30,"button",33),d("click",function(){let t=u(e).$implicit,l=c();return m(l.editCourse(t))}),o(31,"\u270F\uFE0F"),i(),n(32,"button",34),d("click",function(){let t=u(e).$implicit,l=c();return m(l.deleteCourse(t))}),o(33,"\u{1F5D1}\uFE0F"),i()()()()}if(s&2){let e=p.$implicit;a(5),g(e.title),a(2),g(V(8,12,e.createdAt,"mediumDate")),a(3),g(e.instructor),a(3),g(e.category),a(2),S(e.status.toLowerCase()),a(),x(" ",e.status," "),a(2),C(e.price===0?18:19),a(3),g(D(22,15,e.enrollments)),a(6),C(e.status==="UnderReview"?27:-1),a(),C(e.status==="Published"?28:-1),a(),C(e.status==="Archived"||e.status==="Draft"||e.status==="Rejected"?29:-1)}}function X(s,p){s&1&&(n(0,"tr")(1,"td",39)(2,"span"),o(3,"\u{1F4DA}"),i(),n(4,"p"),o(5,"No courses found"),i()()())}function Z(s,p){if(s&1){let e=f();n(0,"div",40),d("click",function(){u(e);let t=c();return m(t.closeModal())}),n(1,"div",41),d("click",function(t){return u(e),m(t.stopPropagation())}),n(2,"div",42)(3,"h2"),o(4,"Review Course"),i(),n(5,"button",43),d("click",function(){u(e);let t=c();return m(t.closeModal())}),o(6,"\xD7"),i()(),n(7,"div",44)(8,"div",45)(9,"h3"),o(10),i(),n(11,"p"),o(12),i()(),n(13,"div",46)(14,"label"),o(15,"Feedback"),i(),n(16,"textarea",47),P("ngModelChange",function(t){u(e);let l=c();return M(l.reviewFeedback,t)||(l.reviewFeedback=t),m(t)}),i()()(),n(17,"div",48)(18,"button",49),d("click",function(){u(e);let t=c();return m(t.confirmReject())}),o(19," Reject "),i(),n(20,"button",50),d("click",function(){u(e);let t=c();return m(t.confirmApprove())}),o(21," Approve "),i()()()()}if(s&2){let e=c();a(10),g(e.selectedCourse==null?null:e.selectedCourse.title),a(2),x("By: ",e.selectedCourse==null?null:e.selectedCourse.instructor,""),a(4),v("ngModel",e.reviewFeedback)}}var de=(()=>{class s{translate=_(I);courseService=_(U);toastr=_($);courses=b([]);filteredCourses=b([]);loading=b(!0);searchQuery="";activeStatus="all";categoryFilter="all";totalCourses=0;publishedCourses=0;pendingCourses=0;draftCourses=0;showReviewModal=!1;selectedCourse=null;reviewFeedback="";ngOnInit(){this.loadCourses()}loadCourses(){this.loading.set(!0),this.courseService.getCourses(1,100).subscribe({next:e=>{if(e.isSuccess&&e.data){let r=e.data.items.map(t=>({id:t.id,slug:t.slug||t.id,title:t.nameEn||t.nameAr||t.title,thumbnail:t.thumbnailUrl||"",instructor:t.instructor?.fullName||"Unknown",category:t.category?.nameEn||t.category?.nameAr||"Uncategorized",status:t.status||"Draft",price:t.discountPrice||t.price||0,enrollments:t.enrollmentCount||0,rating:t.averageRating||0,createdAt:new Date(t.createdAt)}));this.courses.set(r),this.calculateStats(),this.filterCourses()}this.loading.set(!1)},error:()=>{this.toastr.error("Failed to load courses"),this.loading.set(!1)}})}calculateStats(){let e=this.courses();this.totalCourses=e.length,this.publishedCourses=e.filter(r=>r.status==="Published").length,this.pendingCourses=e.filter(r=>r.status==="UnderReview").length,this.draftCourses=e.filter(r=>r.status==="Draft").length}setStatus(e){this.activeStatus=e,this.filterCourses()}filterCourses(){let e=this.courses();if(this.activeStatus!=="all"&&(e=e.filter(r=>r.status===this.activeStatus)),this.categoryFilter!=="all"&&(e=e.filter(r=>r.category===this.categoryFilter)),this.searchQuery){let r=this.searchQuery.toLowerCase();e=e.filter(t=>t.title.toLowerCase().includes(r)||t.instructor.toLowerCase().includes(r))}this.filteredCourses.set(e)}addCourse(){window.location.href="/admin/create-course"}viewCourse(e){window.open(`/courses/${e.slug}`,"_blank")}editCourse(e){window.location.href=`/admin/create-course?id=${e.id}`}approveCourse(e){this.selectedCourse=e,this.showReviewModal=!0}rejectCourse(e){this.selectedCourse=e,this.showReviewModal=!0}archiveCourse(e){confirm("Are you sure you want to archive this course?")&&this.courseService.archiveCourse(e.id).subscribe({next:r=>{r.isSuccess?(this.toastr.success("Course archived"),this.loadCourses()):this.toastr.error("Failed to archive course")},error:()=>{this.toastr.error("Failed to archive course")}})}republishCourse(e){confirm("Are you sure you want to publish this course?")&&this.courseService.publishCourse(e.id).subscribe({next:r=>{r.isSuccess?(this.toastr.success("Course published"),this.loadCourses()):this.toastr.error(r.messageEn||"Failed to publish course")},error:()=>{this.toastr.error("Failed to publish course")}})}deleteCourse(e){confirm("Are you sure you want to delete this course?")&&this.courseService.deleteCourse(e.id).subscribe({next:r=>{r.isSuccess?(this.toastr.success("Course deleted"),this.loadCourses()):this.toastr.error("Failed to delete course")},error:()=>{this.toastr.error("Failed to delete course")}})}confirmApprove(){this.selectedCourse&&this.courseService.publishCourse(this.selectedCourse.id).subscribe({next:e=>{e.isSuccess?(this.toastr.success("Course approved and published"),this.loadCourses()):this.toastr.error("Failed to approve course")},error:()=>{this.toastr.error("Failed to approve course")}}),this.closeModal()}confirmReject(){this.selectedCourse&&this.courseService.rejectCourse(this.selectedCourse.id,this.reviewFeedback).subscribe({next:e=>{e.isSuccess?(this.toastr.success("Course rejected"),this.loadCourses()):this.toastr.error("Failed to reject course")},error:()=>{this.toastr.error("Failed to reject course")}}),this.closeModal()}closeModal(){this.showReviewModal=!1,this.selectedCourse=null,this.reviewFeedback=""}static \u0275fac=function(r){return new(r||s)};static \u0275cmp=k({type:s,selectors:[["app-admin-courses"]],standalone:!0,features:[F],decls:66,vars:7,consts:[[1,"courses-page"],[1,"page-header"],[1,"header-left"],[1,"subtitle"],[1,"add-btn",3,"click"],[1,"stats-row"],[1,"stat-card"],[1,"stat-icon"],[1,"stat-info"],[1,"stat-value"],[1,"stat-label"],[1,"filters-bar"],[1,"search-box"],[1,"search-icon"],["type","text","placeholder","Search courses...",3,"ngModelChange","ngModel"],[1,"table-container"],[1,"pagination"],[1,"page-info"],[1,"page-controls"],["disabled",""],[1,"active"],[1,"modal-overlay"],[1,"course-cell"],[1,"course-info"],[1,"course-title"],[1,"course-date"],[1,"category-badge"],[1,"status-badge"],[1,"free-badge"],[1,"actions-cell"],["title","View",1,"action-btn",3,"click"],["title","Archive",1,"action-btn","warning"],["title","Publish",1,"action-btn","success"],["title","Edit",1,"action-btn",3,"click"],["title","Delete",1,"action-btn","danger",3,"click"],["title","Approve",1,"action-btn","success",3,"click"],["title","Reject",1,"action-btn","danger",3,"click"],["title","Archive",1,"action-btn","warning",3,"click"],["title","Publish",1,"action-btn","success",3,"click"],["colspan","8",1,"empty-state"],[1,"modal-overlay",3,"click"],[1,"modal","review-modal",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],[1,"modal-body"],[1,"course-preview"],[1,"form-group"],["rows","4","placeholder","Enter your feedback...",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"reject-btn",3,"click"],[1,"approve-btn",3,"click"]],template:function(r,t){r&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),o(4,"Course Management"),i(),n(5,"p",3),o(6,"Manage all courses"),i()(),n(7,"button",4),d("click",function(){return t.addCourse()}),n(8,"span"),o(9,"+"),i(),o(10," Add Course "),i()(),n(11,"div",5)(12,"div",6)(13,"span",7),o(14,"\u{1F4DA}"),i(),n(15,"div",8)(16,"span",9),o(17),i(),n(18,"span",10),o(19,"Total Courses"),i()()(),n(20,"div",6)(21,"span",7),o(22,"\u2705"),i(),n(23,"div",8)(24,"span",9),o(25),i(),n(26,"span",10),o(27,"Published"),i()()()(),n(28,"div",11)(29,"div",12)(30,"span",13),o(31,"\u{1F50D}"),i(),n(32,"input",14),P("ngModelChange",function(w){return M(t.searchQuery,w)||(t.searchQuery=w),w}),d("ngModelChange",function(){return t.filterCourses()}),i()()(),n(33,"div",15)(34,"table")(35,"thead")(36,"tr")(37,"th"),o(38,"Course"),i(),n(39,"th"),o(40,"Instructor"),i(),n(41,"th"),o(42,"Category"),i(),n(43,"th"),o(44,"Status"),i(),n(45,"th"),o(46,"Price"),i(),n(47,"th"),o(48,"Enrollments"),i(),n(49,"th"),o(50,"Actions"),i()()(),n(51,"tbody"),y(52,K,34,17,"tr",null,N,!1,X,6,0,"tr"),i()()(),n(55,"div",16)(56,"span",17),o(57),i(),n(58,"div",18)(59,"button",19),o(60,"\u2190"),i(),n(61,"button",20),o(62,"1"),i(),n(63,"button",19),o(64,"\u2192"),i()()()(),h(65,Z,22,3,"div",21)),r&2&&(a(17),g(t.totalCourses),a(8),g(t.publishedCourses),a(7),v("ngModel",t.searchQuery),a(20),E(t.filteredCourses()),a(5),A(" Showing 1-",t.filteredCourses().length," of ",t.filteredCourses().length," "),a(8),C(t.showReviewModal?65:-1))},dependencies:[z,j,T,B,L,Q,W,R],styles:[".courses-page[_ngcontent-%COMP%]{padding:2rem;max-width:1400px;margin:0 auto}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;margin-bottom:.25rem}.subtitle[_ngcontent-%COMP%]{color:#666}.add-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.75rem 1.5rem;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:all .3s ease}.add-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #667eea66}.add-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700}.stats-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:1rem;margin-bottom:2rem}.stat-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:1.25rem;display:flex;align-items:center;gap:1rem;box-shadow:0 2px 12px #0000000f}.stat-icon[_ngcontent-%COMP%]{font-size:2rem}.stat-value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;display:block}.stat-label[_ngcontent-%COMP%]{font-size:.85rem;color:#666}.filters-bar[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:1.5rem;flex-wrap:wrap}.search-box[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.75rem 1rem;background:#fff;border:2px solid #e0e0e0;border-radius:8px;flex:1;min-width:250px;max-width:350px}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;outline:none;width:100%;font-size:.95rem}.filter-tabs[_ngcontent-%COMP%]{display:flex;gap:.5rem;background:#f8f9fa;padding:.25rem;border-radius:8px}.filter-tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.625rem 1rem;border:none;background:transparent;border-radius:6px;font-weight:500;cursor:pointer}.filter-tabs[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#fff;box-shadow:0 2px 8px #00000014}select[_ngcontent-%COMP%]{padding:.75rem 1rem;border:2px solid #e0e0e0;border-radius:8px;font-size:.95rem;background:#fff}.table-container[_ngcontent-%COMP%]{background:#fff;border-radius:16px;box-shadow:0 4px 20px #00000014;overflow:hidden}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%]{text-align:left;padding:1rem 1.25rem;background:#f8f9fa;font-weight:600;font-size:.85rem;color:#666}td[_ngcontent-%COMP%]{padding:1rem 1.25rem;border-bottom:1px solid #f0f0f0;vertical-align:middle}tr[_ngcontent-%COMP%]:hover{background:#f8f9fa}.course-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.course-thumbnail[_ngcontent-%COMP%]{width:60px;height:40px;border-radius:6px;background:#f0f0f0;display:flex;align-items:center;justify-content:center;overflow:hidden}.course-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.course-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.course-title[_ngcontent-%COMP%]{font-weight:600;max-width:200px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.course-date[_ngcontent-%COMP%]{font-size:.8rem;color:#666}.category-badge[_ngcontent-%COMP%]{padding:.25rem .75rem;background:#f0f0f0;border-radius:12px;font-size:.8rem}.status-badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:12px;font-size:.8rem;font-weight:600}.status-badge.published[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.status-badge.draft[_ngcontent-%COMP%]{background:#e2e3e5;color:#383d41}.status-badge.underreview[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.status-badge.rejected[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.free-badge[_ngcontent-%COMP%]{background:#e8f5e9;color:#388e3c;padding:.25rem .75rem;border-radius:12px;font-size:.8rem;font-weight:600}.rating-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:.25rem}.action-btn[_ngcontent-%COMP%]{width:32px;height:32px;border:none;background:transparent;border-radius:6px;cursor:pointer;font-size:.9rem;transition:background .2s}.action-btn[_ngcontent-%COMP%]:hover{background:#f0f0f0}.action-btn.success[_ngcontent-%COMP%]:hover{background:#d1fae5}.action-btn.danger[_ngcontent-%COMP%]:hover{background:#fee2e2}.action-btn.warning[_ngcontent-%COMP%]:hover{background:#fef3c7}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem!important;color:#666}.empty-state[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:3rem;display:block;margin-bottom:1rem}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:1.5rem}.page-info[_ngcontent-%COMP%]{color:#666}.page-controls[_ngcontent-%COMP%]{display:flex;gap:.25rem}.page-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:36px;height:36px;border:1px solid #e0e0e0;background:#fff;border-radius:6px;cursor:pointer;font-weight:500}.page-controls[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#247090;color:#fff;border-color:#247090}.page-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.modal[_ngcontent-%COMP%]{background:#fff;border-radius:16px;width:100%;max-width:500px}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1.5rem;border-bottom:1px solid #e0e0e0}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700}.close-btn[_ngcontent-%COMP%]{width:36px;height:36px;border:none;background:#f0f0f0;border-radius:50%;font-size:1.25rem;cursor:pointer}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.course-preview[_ngcontent-%COMP%]{background:#f8f9fa;padding:1rem;border-radius:8px;margin-bottom:1.5rem}.course-preview[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:.25rem}.course-preview[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9rem;color:#666}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:600}.form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem;border:2px solid #e0e0e0;border-radius:8px;font-size:.95rem;resize:vertical}.modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.75rem;padding:1.5rem;border-top:1px solid #e0e0e0}.reject-btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;background:#dc3545;color:#fff;border-radius:8px;font-weight:600;cursor:pointer}.approve-btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;background:#28a745;color:#fff;border-radius:8px;font-weight:600;cursor:pointer}@media (max-width: 1200px){.stats-row[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (max-width: 768px){.courses-page[_ngcontent-%COMP%]{padding:1rem}.stats-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.filters-bar[_ngcontent-%COMP%]{flex-direction:column}.search-box[_ngcontent-%COMP%]{max-width:none}.table-container[_ngcontent-%COMP%]{overflow-x:auto}}"]})}return s})();export{de as AdminCoursesComponent};
