import{a as g}from"./chunk-JLLNXAHD.js";import{d as h}from"./chunk-L2ZR2CCC.js";import{Q as p,W as m,a as d,b as c,n,r as l,z as o}from"./chunk-Q5RFH5SI.js";var A=(()=>{class u{http=m(h);apiUrl=g.apiUrl;getStudentDashboard(){return this.http.get(`${this.apiUrl}/dashboard/student`).pipe(l(e=>{if(!e.isSuccess||!e.data)return null;let t=e.data,a=(t.enrollments||t.recentEnrollments||[]).map(s=>({id:s.id,courseId:s.courseId,courseTitle:s.courseName||s.courseTitle||"",courseName:s.courseName||s.courseTitle||"",courseThumbnail:s.courseThumbnail||"",courseSlug:s.courseSlug||s.courseId,instructorName:s.instructorName||"",progress:s.progressPercentage||s.progress||0,progressPercentage:s.progressPercentage||s.progress||0,totalSessions:s.totalSessions||0,completedSessions:s.completedSessions||0,status:s.status,enrolledAt:s.createdAt||s.enrolledAt,createdAt:s.createdAt||s.enrolledAt,lastAccessedAt:s.lastAccessedAt})),i=(t.certificates||[]).map(s=>({id:s.id,courseTitle:s.courseTitle||"",courseThumbnail:s.courseThumbnail||"",issuedAt:s.issuedAt||s.createdAt,certificateUrl:s.certificateUrl||"",verificationCode:s.verificationCode||""})),r=(t.badges||t.recentBadges||[]).map(s=>({id:s.id,name:s.nameEn||s.name||"",description:s.descriptionEn||s.description||"",iconUrl:s.iconUrl||"",earnedAt:s.earnedAt}));return c(d({},t),{enrolledCourses:t.totalEnrollments||0,totalEnrollments:t.totalEnrollments||0,completedCourses:t.completedCourses||0,inProgressCourses:t.inProgressCourses||t.activeCourses||0,activeCourses:t.activeCourses||t.inProgressCourses||0,totalCertificates:t.totalCertificates||t.certificatesEarned||0,certificatesEarned:t.certificatesEarned||t.totalCertificates||0,totalBadges:t.totalBadges||t.badgesEarned||0,badgesEarned:t.badgesEarned||t.totalBadges||0,totalXp:t.totalXp||0,currentLevel:t.currentLevel||1,xpToNextLevel:t.xpToNextLevel||1e3,overallProgress:t.overallProgress||0,enrollments:a,recentEnrollments:a,certificates:i,badges:r,recentBadges:r,recentActivity:t.recentActivity||[]})}),o(e=>(console.error("Error fetching student dashboard:",e),n(null))))}getStudentEnrollments(){return this.http.get(`${this.apiUrl}/dashboard/student/enrollments`).pipe(l(e=>e.isSuccess?e.data:[]),o(()=>n([])))}getAdminDashboard(){return this.http.get(`${this.apiUrl}/dashboard/admin`).pipe(l(e=>{if(!e.isSuccess)return null;let t=e.data;return c(d({},t),{totalUsers:(t.totalStudents||0)+(t.totalInstructors||0),recentEnrollments:t.recentEnrollments||[],recentUsers:t.recentUsers||[]})}),o(e=>(console.error("Error fetching admin dashboard:",e),n(null))))}getAuditLogs(e=1,t=50,a){let i=`${this.apiUrl}/dashboard/admin/audit-logs?pageNumber=${e}&pageSize=${t}`;return a&&(i+=`&action=${a}`),this.http.get(i).pipe(l(r=>r.isSuccess?r.data:{items:[],totalCount:0}),o(()=>n({items:[],totalCount:0})))}getUsers(e=1,t=20,a,i){let r=`${this.apiUrl}/dashboard/admin/users?pageNumber=${e}&pageSize=${t}`;return a&&(r+=`&role=${a}`),i&&(r+=`&search=${encodeURIComponent(i)}`),this.http.get(r).pipe(l(s=>s.isSuccess?s.data:{items:[],totalCount:0}),o(()=>n({items:[],totalCount:0})))}updateUserRole(e,t){return this.http.put(`${this.apiUrl}/dashboard/admin/users/${e}/role`,{role:t}).pipe(l(a=>a.isSuccess),o(()=>n(!1)))}toggleUserStatus(e,t){return this.http.put(`${this.apiUrl}/dashboard/admin/users/${e}/status`,{isActive:t}).pipe(l(a=>a.isSuccess),o(()=>n(!1)))}approveEnrollment(e,t=0){return this.http.post(`${this.apiUrl}/enrollments/${e}/approve`,{paidAmount:t}).pipe(l(a=>a.isSuccess),o(()=>n(!1)))}rejectEnrollment(e,t=""){return this.http.post(`${this.apiUrl}/enrollments/${e}/reject`,{reason:t}).pipe(l(a=>a.isSuccess),o(()=>n(!1)))}getInstructorDashboard(){return this.http.get(`${this.apiUrl}/dashboard/instructor`).pipe(l(e=>{if(!e.isSuccess||!e.data)return null;let t=e.data,a=(t.recentCourses||[]).map(r=>({id:r.id,title:r.nameEn||r.title||"Untitled",thumbnail:r.thumbnailUrl||r.thumbnail||"",slug:r.slug||"",enrollments:r.enrollmentCount||r.enrollments||0,revenue:r.revenue||0,rating:r.averageRating||r.rating||0,reviewCount:r.reviewCount||0,completionRate:r.completionRate||0,status:r.status||"Draft",createdAt:r.createdAt,lastUpdatedAt:r.updatedAt||r.createdAt})),i=(t.recentEnrollments||[]).map(r=>({id:r.id,studentName:r.userName||r.studentName||"Unknown",studentAvatar:r.userAvatar||r.studentAvatar||"",studentEmail:r.userEmail||r.studentEmail||"",courseTitle:r.courseName||r.courseTitle||"Unknown",courseThumbnail:r.courseThumbnail||"",amount:r.amountPaid||r.amount||0,enrolledAt:r.createdAt||r.enrolledAt}));return{totalCourses:t.totalCourses||0,publishedCourses:t.publishedCourses||0,draftCourses:t.draftCourses||0,totalStudents:t.totalEnrollments||t.totalStudents||0,totalEnrollments:t.totalEnrollments||0,activeEnrollments:t.activeEnrollments||0,completedEnrollments:t.completedEnrollments||0,totalRevenue:t.totalRevenue||0,monthlyRevenue:t.thisMonthRevenue||t.monthlyRevenue||0,averageRating:t.averageRating||0,totalReviews:t.totalReviews||0,courses:a,recentEnrollments:i}}),o(e=>(console.error("Error fetching instructor dashboard:",e),n(null))))}getInstructorCourses(){return this.http.get(`${this.apiUrl}/dashboard/instructor/courses`).pipe(l(e=>e.isSuccess?e.data:[]),o(()=>n([])))}getCourseAnalytics(e){return this.http.get(`${this.apiUrl}/dashboard/instructor/courses/${e}/analytics`).pipe(l(t=>t.isSuccess?t.data:null),o(()=>n(null)))}getInstructorStudents(e=1,t=50){return this.http.get(`${this.apiUrl}/dashboard/instructor/students?pageNumber=${e}&pageSize=${t}`).pipe(l(a=>{if(a.isSuccess&&a.data){let i=a.data;return{students:(i.items||[]).map(r=>({id:r.id,name:r.name,email:r.email,phone:r.phone,profileImageUrl:r.profileImageUrl||"",courseName:r.courseName,courseId:r.courseId,enrollmentId:r.enrollmentId,progress:r.progress||0,enrolledAt:r.enrolledAt,lastActiveAt:r.lastActiveAt})),totalCount:i.totalCount||0,pageNumber:i.pageNumber||e,pageSize:i.pageSize||t}}return{students:[],totalCount:0,pageNumber:e,pageSize:t}}),o(()=>n({students:[],totalCount:0,pageNumber:e,pageSize:t})))}getStudentDetail(e){return this.http.get(`${this.apiUrl}/dashboard/instructor/students/${e}`).pipe(l(t=>t.isSuccess&&t.data?t.data:null),o(()=>n(null)))}removeStudentFromCourse(e,t){let a=t?`${this.apiUrl}/dashboard/instructor/students/${e}?reason=${encodeURIComponent(t)}`:`${this.apiUrl}/dashboard/instructor/students/${e}`;return this.http.delete(a).pipe(l(i=>i.isSuccess===!0),o(()=>n(!1)))}getInstructors(){return this.http.get(`${this.apiUrl}/dashboard/admin/instructors`).pipe(l(e=>e.isSuccess?e.data:[]),o(()=>n([])))}getContactMessages(e=1,t=100,a){let i=`${this.apiUrl}/dashboard/admin/contact-messages?pageNumber=${e}&pageSize=${t}`;return a!==void 0&&(i+=`&isRead=${a}`),this.http.get(i).pipe(o(()=>n({isSuccess:!1,data:[]})))}markMessageAsRead(e){return this.http.post(`${this.apiUrl}/dashboard/admin/contact-messages/${e}/read`,{}).pipe(o(()=>n({isSuccess:!1})))}deleteContactMessage(e){return this.http.delete(`${this.apiUrl}/dashboard/admin/contact-messages/${e}`).pipe(o(()=>n({isSuccess:!1})))}static \u0275fac=function(t){return new(t||u)};static \u0275prov=p({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})();export{A as a};
