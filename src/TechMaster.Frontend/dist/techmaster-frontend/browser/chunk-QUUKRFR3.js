import{a as R}from"./chunk-XQGCPSEC.js";import{a as I}from"./chunk-ZAODAAZN.js";import{b as D,c as C,d as z,e as L,h as H,k as j,l as A,s as G,t as q,u as B}from"./chunk-HRUO5R4Q.js";import{a as F}from"./chunk-QFQZ7TF5.js";import"./chunk-XAZLOLJU.js";import{a as T}from"./chunk-UYI4POZX.js";import"./chunk-JLLNXAHD.js";import"./chunk-SAC5YDHM.js";import"./chunk-AJDLSE77.js";import"./chunk-L2ZR2CCC.js";import{$a as P,Ab as i,Bb as E,Cb as k,Ja as O,Jb as N,Na as a,W as v,Wa as b,Y as U,cb as f,eb as y,ga as m,gb as _,ha as p,lb as n,mb as e,mc as V,nb as l,qb as x,sb as u,tb as g,yb as S}from"./chunk-Q5RFH5SI.js";function X(s,w){if(s&1){let t=x();n(0,"div",35)(1,"span",29),i(2,"description"),e(),n(3,"span"),i(4,"CV uploaded"),e(),n(5,"a",42),i(6,"View"),e(),n(7,"button",43),u("click",function(){m(t);let r=g(2);return p(r.removeCv())}),i(8,"Remove"),e()()}if(s&2){let t=g(2);a(5),f("href",t.cvUrl(),O)}}function J(s,w){s&1&&l(0,"span",38)}function Q(s,w){s&1&&l(0,"span",38)}function W(s,w){if(s&1){let t=x();n(0,"div",16)(1,"h2"),i(2,"Personal Info"),e(),n(3,"form",17),u("ngSubmit",function(){m(t);let r=g();return p(r.savePersonalInfo())}),n(4,"div",18)(5,"div",19)(6,"label"),i(7,"First Name"),e(),l(8,"input",20),e(),n(9,"div",19)(10,"label"),i(11,"Last Name"),e(),l(12,"input",21),e()(),n(13,"div",18)(14,"div",19)(15,"label"),i(16,"Email"),e(),l(17,"input",22),e(),n(18,"div",19)(19,"label"),i(20,"Phone"),e(),l(21,"input",23),e()(),n(22,"div",18)(23,"div",19)(24,"label"),i(25,"Country"),e(),l(26,"input",24),e(),n(27,"div",19)(28,"label"),i(29,"City"),e(),l(30,"input",25),e()(),n(31,"div",26)(32,"label"),i(33,"Bio"),e(),l(34,"textarea",27),e(),n(35,"h3",28),i(36,"Social & Professional Links"),e(),n(37,"div",18)(38,"div",19)(39,"label")(40,"span",29),i(41,"link"),e(),i(42," LinkedIn "),e(),l(43,"input",30),e(),n(44,"div",19)(45,"label")(46,"span",29),i(47,"code"),e(),i(48," GitHub "),e(),l(49,"input",31),e()(),n(50,"div",18)(51,"div",19)(52,"label")(53,"span",29),i(54,"work"),e(),i(55," Portfolio "),e(),l(56,"input",32),e(),n(57,"div",19)(58,"label")(59,"span",29),i(60,"language"),e(),i(61," Website "),e(),l(62,"input",33),e()(),n(63,"div",26)(64,"label")(65,"span",29),i(66,"description"),e(),i(67," CV / Resume "),e(),n(68,"div",34),P(69,X,9,1,"div",35),n(70,"input",36,1),u("change",function(r){m(t);let c=g();return p(c.onCvSelected(r))}),e(),n(72,"button",37),u("click",function(){m(t);let r=S(71);return p(r.click())}),P(73,J,1,0,"span",38),i(74),e(),n(75,"span",39),i(76,"PDF, DOC or DOCX (max 5MB)"),e()()(),n(77,"div",40)(78,"button",41),P(79,Q,1,0,"span",38),i(80," Save Changes "),e()()()()}if(s&2){let t=g();a(3),f("formGroup",t.personalForm),a(66),_(t.cvUrl()?69:-1),a(3),f("disabled",t.uploadingCv()),a(),_(t.uploadingCv()?73:-1),a(),k(" ",t.cvUrl()?"Replace CV":"Upload CV"," "),a(4),f("disabled",t.savingPersonal()),a(),_(t.savingPersonal()?79:-1)}}function Y(s,w){if(s&1){let t=x();n(0,"div",16)(1,"h2"),i(2,"Security"),e(),n(3,"div",44)(4,"h3"),i(5,"Change Password"),e(),n(6,"form",17),u("ngSubmit",function(){m(t);let r=g();return p(r.changePassword())}),n(7,"div",19)(8,"label"),i(9,"Current Password"),e(),l(10,"input",45),e(),n(11,"div",19)(12,"label"),i(13,"New Password"),e(),l(14,"input",46),e(),n(15,"div",19)(16,"label"),i(17,"Confirm Password"),e(),l(18,"input",47),e(),n(19,"button",41),i(20," Update Password "),e()()()()}if(s&2){let t=g();a(6),f("formGroup",t.passwordForm),a(13),f("disabled",t.savingPassword())}}var le=(()=>{class s{authService=v(I);fb=v(G);toastr=v(F);fileUploadService=v(R);mediaService=v(T);activeTab=b("personal");savingPersonal=b(!1);savingPassword=b(!1);uploadingCv=b(!1);profileImageUrl=b(null);cvUrl=b(null);emailNotifications=!0;courseUpdates=!0;promotional=!1;selectedLanguage="en";selectedTheme="light";videoQuality="auto";personalForm=this.fb.group({firstName:["",C.required],lastName:["",C.required],email:[""],phone:[""],bio:[""],country:[""],city:[""],linkedInUrl:[""],gitHubUrl:[""],portfolioUrl:[""],websiteUrl:[""]});passwordForm=this.fb.group({currentPassword:["",C.required],newPassword:["",[C.required,C.minLength(8)]],confirmPassword:["",C.required]});ngOnInit(){this.loadUserData()}loadUserData(){let t=this.authService.getCurrentUser();t&&(this.personalForm.patchValue({firstName:t.firstName||"",lastName:t.lastName||"",email:t.email||"",phone:t.phone||"",bio:t.bio||"",country:t.country||"",city:t.city||"",linkedInUrl:t.linkedInUrl||"",gitHubUrl:t.gitHubUrl||"",portfolioUrl:t.portfolioUrl||"",websiteUrl:t.websiteUrl||""}),this.profileImageUrl.set(this.mediaService.getAvatarUrl(t.profileImageUrl)||null),this.cvUrl.set(t.cvUrl?this.mediaService.getMediaUrl(t.cvUrl):null)),this.selectedLanguage="en"}onAvatarSelected(t){let o=t.target;if(o.files&&o.files[0]){let r=o.files[0];if(r.size>5*1024*1024){this.toastr.error("Photo must be less than 5MB");return}this.fileUploadService.uploadImage(r).subscribe({next:c=>{if(c.status==="complete"&&c.response?.data?.url){let d=c.response.data.url;this.profileImageUrl.set(this.mediaService.getAvatarUrl(d)),this.authService.updateProfile({profileImageUrl:d}).subscribe({next:h=>{if(h?.isSuccess){this.toastr.success("Photo updated successfully");let M=this.authService.getCurrentUser();M&&(M.profileImageUrl=d,localStorage.setItem("user",JSON.stringify(M)))}}})}},error:()=>{this.toastr.error("Failed to upload photo")}})}}savePersonalInfo(){if(this.personalForm.invalid)return;this.savingPersonal.set(!0);let t=this.personalForm.value;this.authService.updateProfile({firstName:t.firstName,lastName:t.lastName,phone:t.phone,bio:t.bio,country:t.country,city:t.city,linkedInUrl:t.linkedInUrl,gitHubUrl:t.gitHubUrl,portfolioUrl:t.portfolioUrl,websiteUrl:t.websiteUrl,cvUrl:this.cvUrl()||void 0}).subscribe({next:o=>{this.savingPersonal.set(!1),o.isSuccess?this.toastr.success("Profile saved successfully","Success"):this.toastr.error(o.message||"Failed to save profile","Error")},error:()=>{this.savingPersonal.set(!1),this.toastr.error("Failed to save profile","Error")}})}onCvSelected(t){let o=t.target;if(o.files&&o.files[0]){let r=o.files[0];if(r.size>5*1024*1024){this.toastr.error("CV must be less than 5MB");return}if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(r.type)){this.toastr.error("Please upload a PDF, DOC or DOCX file");return}this.uploadingCv.set(!0),this.fileUploadService.uploadDocument(r).subscribe({next:d=>{d.status==="complete"&&d.response?.data?.url?(this.cvUrl.set(d.response.data.url),this.uploadingCv.set(!1),this.toastr.success("CV uploaded successfully")):d.status==="error"&&(this.uploadingCv.set(!1),this.toastr.error(d.error||"Failed to upload CV"))},error:()=>{this.uploadingCv.set(!1),this.toastr.error("Failed to upload CV")}})}}removeCv(){this.cvUrl.set(null),this.toastr.info("CV removed. Click Save Changes to update.")}changePassword(){if(this.passwordForm.invalid)return;let{currentPassword:t,newPassword:o,confirmPassword:r}=this.passwordForm.value;if(o!==r){this.toastr.error("Passwords do not match","Error");return}this.savingPassword.set(!0),this.authService.changePassword(t,o).subscribe({next:c=>{this.savingPassword.set(!1),c.isSuccess?(this.passwordForm.reset(),this.toastr.success("Password updated successfully","Success")):this.toastr.error(c.messageEn||"Failed to update password","Error")},error:()=>{this.savingPassword.set(!1),this.toastr.error("Failed to update password","Error")}})}changeLanguage(){document.documentElement.lang=this.selectedLanguage,document.documentElement.dir=this.selectedLanguage==="ar"?"rtl":"ltr"}static \u0275fac=function(o){return new(o||s)};static \u0275cmp=U({type:s,selectors:[["app-profile"]],standalone:!0,features:[N],decls:32,vars:9,consts:[["avatarInput",""],["cvInput",""],[1,"profile-page"],[1,"page-header"],[1,"profile-content"],[1,"profile-sidebar"],[1,"profile-avatar"],[1,"avatar-wrapper"],["alt","Profile",3,"src"],["type","file","accept","image/*",2,"display","none",3,"change"],[1,"change-avatar-btn",3,"click"],[1,"role-badge"],[1,"profile-nav"],[1,"nav-item",3,"click"],[1,"icon"],[1,"profile-main"],[1,"tab-content"],[3,"ngSubmit","formGroup"],[1,"form-row"],[1,"form-group"],["type","text","formControlName","firstName"],["type","text","formControlName","lastName"],["type","email","formControlName","email","readonly",""],["type","tel","formControlName","phone"],["type","text","formControlName","country"],["type","text","formControlName","city"],[1,"form-group","full-width"],["formControlName","bio","rows","4","placeholder","Tell us about yourself..."],[1,"section-title"],[1,"material-icons"],["type","url","formControlName","linkedInUrl","placeholder","https://linkedin.com/in/username"],["type","url","formControlName","gitHubUrl","placeholder","https://github.com/username"],["type","url","formControlName","portfolioUrl","placeholder","https://yourportfolio.com"],["type","url","formControlName","websiteUrl","placeholder","https://yourwebsite.com"],[1,"cv-upload-wrapper"],[1,"cv-preview"],["type","file","accept",".pdf,.doc,.docx",2,"display","none",3,"change"],["type","button",1,"upload-cv-btn",3,"click","disabled"],[1,"spinner"],[1,"help-text"],[1,"form-actions"],["type","submit",1,"save-btn",3,"disabled"],["target","_blank",1,"view-cv-btn",3,"href"],["type","button",1,"remove-cv-btn",3,"click"],[1,"security-section"],["type","password","formControlName","currentPassword"],["type","password","formControlName","newPassword"],["type","password","formControlName","confirmPassword"]],template:function(o,r){if(o&1){let c=x();n(0,"div",2)(1,"div",3)(2,"h1"),i(3,"My Profile"),e(),n(4,"p"),i(5,"Manage your account information and preferences"),e()(),n(6,"div",4)(7,"aside",5)(8,"div",6)(9,"div",7),l(10,"img",8),n(11,"input",9,0),u("change",function(h){return m(c),p(r.onAvatarSelected(h))}),e(),n(13,"button",10),u("click",function(){m(c);let h=S(12);return p(h.click())}),n(14,"span"),i(15,"\u{1F4F7}"),e()()(),n(16,"h3"),i(17),e(),n(18,"span",11),i(19),e()(),n(20,"nav",12)(21,"button",13),u("click",function(){return m(c),p(r.activeTab.set("personal"))}),n(22,"span",14),i(23,"\u{1F464}"),e(),i(24," Personal Info "),e(),n(25,"button",13),u("click",function(){return m(c),p(r.activeTab.set("security"))}),n(26,"span",14),i(27,"\u{1F512}"),e(),i(28," Security "),e()()(),n(29,"main",15),P(30,W,81,7,"div",16)(31,Y,21,2,"div",16),e()()()}if(o&2){let c,d;a(10),f("src",r.profileImageUrl()||"assets/images/default-avatar.png",O),a(7),E((c=r.authService.getCurrentUser())==null?null:c.fullName),a(2),E((d=r.authService.getCurrentUser())==null?null:d.role),a(2),y("active",r.activeTab()==="personal"),a(4),y("active",r.activeTab()==="security"),a(5),_(r.activeTab()==="personal"?30:-1),a(),_(r.activeTab()==="security"?31:-1)}},dependencies:[V,q,H,D,z,L,B,j,A],styles:['.profile-page[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:2rem}.page-header[_ngcontent-%COMP%]{margin-bottom:2rem}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#000;margin-bottom:.5rem}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666}.profile-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:280px 1fr;gap:2rem}.profile-sidebar[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:1.5rem;box-shadow:0 4px 20px #00000014;height:fit-content}.profile-avatar[_ngcontent-%COMP%]{text-align:center;padding-bottom:1.5rem;border-bottom:1px solid #e0e0e0;margin-bottom:1.5rem}.avatar-wrapper[_ngcontent-%COMP%]{position:relative;display:inline-block;margin-bottom:1rem}.avatar-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:50%;object-fit:cover;border:4px solid #247090}.change-avatar-btn[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0;width:32px;height:32px;background:#247090;border:3px solid #fff;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:.9rem}.profile-avatar[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;color:#000;margin-bottom:.25rem}.role-badge[_ngcontent-%COMP%]{display:inline-block;padding:.25rem .75rem;background:#e8f4f8;color:#247090;border-radius:20px;font-size:.8rem;font-weight:600}.profile-nav[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.nav-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.875rem 1rem;background:none;border:none;border-radius:10px;font-size:.95rem;color:#666;cursor:pointer;transition:all .3s ease;text-align:left}.nav-item[_ngcontent-%COMP%]:hover{background:#f8f9fa;color:#000}.nav-item.active[_ngcontent-%COMP%]{background:#e8f4f8;color:#247090;font-weight:600}.profile-main[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:2rem;box-shadow:0 4px 20px #00000014}.tab-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#000;margin-bottom:1.5rem}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}.form-group.full-width[_ngcontent-%COMP%]{grid-column:1/-1}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:.5rem;font-weight:500;color:#333}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:18px;color:#666}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.875rem 1rem;border:2px solid #e0e0e0;border-radius:10px;font-size:1rem;transition:all .3s ease}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#247090}.form-group[_ngcontent-%COMP%]   input[readonly][_ngcontent-%COMP%]{background:#f8f9fa;color:#666}.section-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:#333;margin:2rem 0 1rem;padding-top:1.5rem;border-top:1px solid #e0e0e0}.cv-upload-wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;gap:1rem}.cv-preview[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.75rem 1rem;background:#f8f9fa;border-radius:8px}.cv-preview[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:#247090}.view-cv-btn[_ngcontent-%COMP%], .remove-cv-btn[_ngcontent-%COMP%]{padding:.25rem .5rem;border-radius:4px;font-size:.875rem;cursor:pointer;text-decoration:none}.view-cv-btn[_ngcontent-%COMP%]{background:#247090;color:#fff;border:none}.remove-cv-btn[_ngcontent-%COMP%]{background:transparent;color:#dc3545;border:1px solid #dc3545}.upload-cv-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.75rem 1.5rem;background:#f8f9fa;border:2px dashed #ccc;border-radius:8px;font-weight:500;cursor:pointer;transition:all .2s}.upload-cv-btn[_ngcontent-%COMP%]:hover:not(:disabled){border-color:#247090;background:#e8f4f8}.help-text[_ngcontent-%COMP%]{font-size:.85rem;color:#666}.form-actions[_ngcontent-%COMP%]{margin-top:1.5rem}.save-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;gap:.5rem;padding:.875rem 2rem;background:linear-gradient(135deg,#247090,#1a5570);color:#fff;border:none;border-radius:10px;font-size:1rem;font-weight:600;cursor:pointer;transition:all .3s ease}.save-btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 8px 25px #2470904d}.save-btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.spinner[_ngcontent-%COMP%]{width:18px;height:18px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.security-section[_ngcontent-%COMP%]{padding:1.5rem 0;border-bottom:1px solid #e0e0e0}.security-section[_ngcontent-%COMP%]:last-child{border-bottom:none}.security-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;margin-bottom:.5rem}.section-desc[_ngcontent-%COMP%]{color:#666;margin-bottom:1rem;font-size:.9rem}.enable-2fa-btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:#000;color:#fff;border:none;border-radius:8px;font-weight:600;cursor:pointer}.danger-zone[_ngcontent-%COMP%]{background:#fff5f5;margin:1.5rem -2rem -2rem;padding:1.5rem 2rem!important;border-radius:0 0 16px 16px}.danger-zone[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#dc3545}.delete-btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:#dc3545;color:#fff;border:none;border-radius:8px;font-weight:600;cursor:pointer}.notification-settings[_ngcontent-%COMP%], .preference-settings[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.setting-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem;background:#f8f9fa;border-radius:10px}.setting-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;margin-bottom:.25rem}.setting-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.85rem;color:#666}.toggle[_ngcontent-%COMP%]{position:relative;display:inline-block;width:50px;height:28px}.toggle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#ccc;transition:.4s;border-radius:28px}.slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:22px;width:22px;left:3px;bottom:3px;background-color:#fff;transition:.4s;border-radius:50%}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:#247090}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(22px)}.setting-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.5rem 1rem;border:2px solid #e0e0e0;border-radius:8px;font-size:.95rem;background:#fff}@media (max-width: 992px){.profile-content[_ngcontent-%COMP%]{grid-template-columns:1fr}.profile-sidebar[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.profile-avatar[_ngcontent-%COMP%]{border-bottom:none;padding-bottom:0;margin-bottom:0}.profile-nav[_ngcontent-%COMP%]{flex-direction:row;flex-wrap:wrap;justify-content:center}}@media (max-width: 576px){.profile-page[_ngcontent-%COMP%]{padding:1rem}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.profile-main[_ngcontent-%COMP%]{padding:1.5rem}}']})}return s})();export{le as ProfileComponent};
