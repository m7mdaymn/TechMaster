import{a as d}from"./chunk-JLLNXAHD.js";import{d as h}from"./chunk-L2ZR2CCC.js";import{Q as c,W as o,a as p,b as n,n as i,r as a,z as r}from"./chunk-Q5RFH5SI.js";var C=(()=>{class l{http=o(h);apiUrl=d.apiUrl;getDashboard(){return this.http.get(`${this.apiUrl}/dashboard/instructor`).pipe(a(t=>t.isSuccess?t.data:null),r(()=>i(null)))}getMyCourses(){return this.http.get(`${this.apiUrl}/dashboard/instructor/courses`).pipe(a(t=>t.isSuccess?t.data:[]),r(()=>i([])))}getCourse(t){return this.http.get(`${this.apiUrl}/courses/${t}`).pipe(a(e=>e.isSuccess?e.data:null),r(()=>i(null)))}createCourse(t){return this.http.post(`${this.apiUrl}/courses`,t).pipe(a(e=>e.isSuccess?e.data:null),r(()=>i(null)))}updateCourse(t,e){return this.http.put(`${this.apiUrl}/courses/${t}`,e).pipe(a(s=>s.isSuccess),r(()=>i(!1)))}deleteCourse(t){return this.http.delete(`${this.apiUrl}/courses/${t}`).pipe(a(e=>e.isSuccess),r(()=>i(!1)))}getCourseAnalytics(t){return this.http.get(`${this.apiUrl}/dashboard/instructor/courses/${t}/analytics`).pipe(a(e=>{if(e.isSuccess&&e.data){let s=e.data;return{courseId:s.courseId,courseName:s.courseName||"",totalEnrollments:s.totalEnrollments||0,activeStudents:s.activeEnrollments||s.activeStudents||0,completionRate:s.completionRate||0,averageRating:s.averageRating||0,totalRevenue:s.totalRevenue||0,enrollmentTrend:(s.enrollmentTrends||[]).map(u=>({month:new Date(u.date).toLocaleDateString("en-US",{month:"short"}),count:u.count})),moduleProgress:(s.sessionAnalytics||[]).map(u=>({moduleId:u.sessionId,moduleName:u.sessionName||"Session",completedCount:Math.round((u.completionRate||0)*s.totalEnrollments/100),completionRate:u.completionRate||0})),recentActivity:[]}}return null}),r(()=>i(null)))}createModule(t,e){return this.http.post(`${this.apiUrl}/courses/${t}/modules`,e).pipe(a(s=>s.isSuccess?s.data:null),r(()=>i(null)))}updateModule(t,e){return this.http.put(`${this.apiUrl}/courses/modules/${t}`,e).pipe(a(s=>s.isSuccess),r(()=>i(!1)))}deleteModule(t){return this.http.delete(`${this.apiUrl}/courses/modules/${t}`).pipe(a(e=>e.isSuccess),r(()=>i(!1)))}reorderModules(t,e){return this.http.post(`${this.apiUrl}/courses/${t}/modules/reorder`,e).pipe(a(s=>s.isSuccess),r(()=>i(!1)))}createSession(t,e){return this.http.post(`${this.apiUrl}/courses/modules/${t}/sessions`,e).pipe(a(s=>s.isSuccess?s.data:null),r(()=>i(null)))}updateSession(t,e){return this.http.put(`${this.apiUrl}/courses/sessions/${t}`,e).pipe(a(s=>s.isSuccess),r(()=>i(!1)))}deleteSession(t){return this.http.delete(`${this.apiUrl}/courses/sessions/${t}`).pipe(a(e=>e.isSuccess),r(()=>i(!1)))}reorderSessions(t,e){return this.http.post(`${this.apiUrl}/courses/modules/${t}/sessions/reorder`,e).pipe(a(s=>s.isSuccess),r(()=>i(!1)))}addSessionMaterial(t,e){return this.http.post(`${this.apiUrl}/courses/sessions/${t}/materials`,e).pipe(a(s=>s.isSuccess?s.data:null),r(()=>i(null)))}deleteMaterial(t){return this.http.delete(`${this.apiUrl}/courses/materials/${t}`).pipe(a(e=>e.isSuccess),r(()=>i(!1)))}getNotifications(t=20){return this.http.get(`${this.apiUrl}/notifications`,{params:{count:t.toString()}}).pipe(a(e=>e.isSuccess&&e.data?e.data.map(s=>({id:s.id,title:s.titleEn||s.title||"",titleAr:s.titleAr,message:s.messageEn||s.message||"",messageAr:s.messageAr,type:s.type,isRead:s.isRead,link:s.actionUrl||s.link,createdAt:s.createdAt})):[]),r(()=>i([])))}getUnreadNotificationCount(){return this.http.get(`${this.apiUrl}/notifications/unread-count`).pipe(a(t=>t.isSuccess?t.data:0),r(()=>i(0)))}markNotificationAsRead(t){return this.http.post(`${this.apiUrl}/notifications/${t}/read`,{}).pipe(a(e=>e.isSuccess),r(()=>i(!1)))}markAllNotificationsAsRead(){return this.http.post(`${this.apiUrl}/notifications/read-all`,{}).pipe(a(t=>t.isSuccess),r(()=>i(!1)))}getChatRooms(){return this.http.get(`${this.apiUrl}/chat/rooms`).pipe(a(t=>t.isSuccess&&t.data?t.data.map(e=>this.mapChatRoom(e)):[]),r(()=>i([])))}getChatRoom(t){return this.http.get(`${this.apiUrl}/chat/rooms/${t}`).pipe(a(e=>e.isSuccess&&e.data?this.mapChatRoom(e.data):null),r(()=>i(null)))}getChatMessages(t,e=50){return this.http.get(`${this.apiUrl}/chat/rooms/${t}/messages`,{params:{count:e.toString()}}).pipe(a(s=>s.isSuccess&&s.data?s.data.map(u=>this.mapChatMessage(u)):[]),r(()=>i([])))}sendMessage(t,e){return this.http.post(`${this.apiUrl}/chat/rooms/${t}/messages`,{content:e}).pipe(a(s=>s.isSuccess&&s.data?this.mapChatMessage(s.data):null),r(()=>i(null)))}mapChatRoom(t){return{id:t.id,name:t.name,courseId:t.courseId,courseName:t.courseName,participantCount:t.memberCount??t.participantCount??0,lastMessage:t.lastMessage?this.mapChatMessage(t.lastMessage):void 0,unreadCount:t.unreadCount??0}}mapChatMessage(t){return{id:t.id,roomId:t.chatRoomId||t.roomId||"",senderId:t.senderId,senderName:t.senderName||"",senderPhotoUrl:t.senderProfileImage||t.senderPhotoUrl,content:t.content||"",createdAt:t.createdAt,isRead:t.isRead??!1}}createCourseChat(t){return this.http.post(`${this.apiUrl}/chat/rooms/course/${t}`,{}).pipe(a(e=>e.isSuccess&&e.data?this.mapChatRoom(e.data):null),r(()=>i(null)))}getMyStudents(){return this.http.get(`${this.apiUrl}/dashboard/instructor/students`).pipe(a(t=>t.isSuccess?t.data:[]),r(()=>i([])))}getStudentDetails(t){return this.http.get(`${this.apiUrl}/dashboard/instructor/students/${t}`).pipe(a(e=>e.isSuccess?e.data:null),r(()=>i(null)))}getEarnings(){return this.http.get(`${this.apiUrl}/dashboard/instructor/earnings`).pipe(a(t=>t.isSuccess?t.data:null),r(()=>i(null)))}getLiveSessions(){return this.http.get(`${this.apiUrl}/dashboard/instructor/live-sessions`).pipe(a(t=>t.isSuccess?t.data:[]),r(()=>i([])))}createLiveSession(t){return this.http.post(`${this.apiUrl}/dashboard/instructor/live-sessions`,t).pipe(a(e=>e.isSuccess?e.data:null),r(()=>i(null)))}updateLiveSession(t,e){return this.http.put(`${this.apiUrl}/dashboard/instructor/live-sessions/${t}`,e).pipe(a(s=>s.isSuccess?s.data:null),r(()=>i(null)))}deleteLiveSession(t){return this.http.delete(`${this.apiUrl}/dashboard/instructor/live-sessions/${t}`).pipe(a(e=>e.isSuccess),r(()=>i(!1)))}getMyQuizzes(){return this.getMyCourses().pipe(a(t=>t.map(e=>e.id)),r(()=>i([])))}getCourseQuizzes(t){return this.http.get(`${this.apiUrl}/quizzes/course/${t}`).pipe(a(e=>e.isSuccess?e.data:[]),r(()=>i([])))}createQuiz(t,e){return this.http.post(`${this.apiUrl}/quizzes`,n(p({},e),{courseId:t})).pipe(a(s=>s.isSuccess?s.data:null),r(()=>i(null)))}updateQuiz(t,e){return this.http.put(`${this.apiUrl}/quizzes/${t}`,e).pipe(a(s=>s.isSuccess?s.data:null),r(()=>i(null)))}deleteQuiz(t){return this.http.delete(`${this.apiUrl}/quizzes/${t}`).pipe(a(e=>e.isSuccess),r(()=>i(!1)))}getQuizQuestions(t){return this.http.get(`${this.apiUrl}/quizzes/${t}/questions`).pipe(a(e=>e.isSuccess?e.data:[]),r(()=>i([])))}saveQuizQuestions(t,e){return this.http.put(`${this.apiUrl}/quizzes/${t}/questions`,e).pipe(a(s=>s.isSuccess),r(()=>i(!1)))}toggleQuizPublish(t,e){return this.http.put(`${this.apiUrl}/quizzes/${t}`,{isActive:e}).pipe(a(s=>s.isSuccess),r(()=>i(!1)))}getCourseModules(t){return this.http.get(`${this.apiUrl}/courses/${t}/modules`).pipe(a(e=>e.isSuccess?e.data:[]),r(()=>i([])))}getCategories(){return this.http.get(`${this.apiUrl}/courses/categories`).pipe(a(t=>t.isSuccess?t.data:[]),r(()=>i([])))}static \u0275fac=function(e){return new(e||l)};static \u0275prov=c({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})();export{C as a};
