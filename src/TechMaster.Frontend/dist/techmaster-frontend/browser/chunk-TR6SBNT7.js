import{a as q}from"./chunk-QE2MCLLX.js";import{b as $,d as W,g as B,t as Y}from"./chunk-HRUO5R4Q.js";import{a as N}from"./chunk-QFQZ7TF5.js";import"./chunk-XAZLOLJU.js";import"./chunk-JLLNXAHD.js";import"./chunk-AJDLSE77.js";import"./chunk-L2ZR2CCC.js";import{$a as C,Ab as a,Bb as d,Cb as T,Db as F,Fb as z,Gb as j,Hb as R,Ja as v,Jb as V,Mb as I,Na as r,Ob as L,W as w,Wa as x,Y as S,cb as P,eb as b,ga as _,gb as M,ha as f,ic as Q,jb as E,kb as A,lb as n,mb as i,mc as U,nb as D,qb as O,sb as m,tb as g}from"./chunk-Q5RFH5SI.js";var G=(l,p)=>p.id;function H(l,p){l&1&&(n(0,"div",15),D(1,"div",19),n(2,"p"),a(3,"Loading messages..."),i()())}function J(l,p){l&1&&(n(0,"div",16)(1,"span",20),a(2,"\u{1F4ED}"),i(),n(3,"h3"),a(4,"No Messages"),i(),n(5,"p"),a(6,"No contact messages found"),i()())}function K(l,p){l&1&&(n(0,"span",30),a(1,"New"),i())}function X(l,p){if(l&1){let e=O();n(0,"button",36),m("click",function(t){_(e);let s=g().$implicit,c=g(2);return f(c.markAsRead(s,t))}),a(1," \u2713 Mark Read "),i()}}function Z(l,p){if(l&1){let e=O();n(0,"div",22),m("click",function(){let t=_(e).$implicit,s=g(2);return f(s.viewMessage(t))}),n(1,"div",23)(2,"div",24)(3,"div",25),a(4),i(),n(5,"div",26)(6,"h4"),a(7),i(),n(8,"span",27),a(9),i()()(),n(10,"div",28)(11,"span",29),a(12),i(),C(13,K,2,0,"span",30),i()(),n(14,"div",31)(15,"strong"),a(16),i()(),n(17,"div",32),a(18),i(),n(19,"div",33),C(20,X,2,0,"button",34),n(21,"button",35),m("click",function(t){let s=_(e).$implicit,c=g(2);return f(c.deleteMessage(s,t))}),a(22," \u{1F5D1}\uFE0F Delete "),i()()()}if(l&2){let e=p.$implicit,o=g(2);b("unread",!e.isRead),r(3),b("unread",!e.isRead),r(),T(" ",e.name.charAt(0).toUpperCase()," "),r(3),d(e.name),r(2),d(e.email),r(3),d(o.formatDate(e.createdAt)),r(),M(e.isRead?-1:13),r(3),d(e.subject),r(2),F(" ",e.message.substring(0,150),"",e.message.length>150?"...":""," "),r(2),M(e.isRead?-1:20)}}function ee(l,p){if(l&1&&(n(0,"div",17),E(1,Z,23,13,"div",21,G),i()),l&2){let e=g();r(),A(e.filteredMessages())}}function te(l,p){if(l&1&&(n(0,"div",42)(1,"label"),a(2,"Phone:"),i(),n(3,"a",43),a(4),i()()),l&2){let e,o,t=g(2);r(3),P("href","tel:"+((e=t.selectedMessage())==null?null:e.phone),v),r(),d((o=t.selectedMessage())==null?null:o.phone)}}function ne(l,p){if(l&1){let e=O();n(0,"div",37),m("click",function(){_(e);let t=g();return f(t.selectedMessage.set(null))}),n(1,"div",38),m("click",function(t){return _(e),f(t.stopPropagation())}),n(2,"div",39)(3,"h2"),a(4,"Message Details"),i(),n(5,"button",40),m("click",function(){_(e);let t=g();return f(t.selectedMessage.set(null))}),a(6,"\u2715"),i()(),n(7,"div",41)(8,"div",42)(9,"label"),a(10,"From:"),i(),n(11,"span"),a(12),i()(),n(13,"div",42)(14,"label"),a(15,"Email:"),i(),n(16,"a",43),a(17),i()(),C(18,te,5,2,"div",42),n(19,"div",42)(20,"label"),a(21,"Subject:"),i(),n(22,"span"),a(23),i()(),n(24,"div",42)(25,"label"),a(26,"Date:"),i(),n(27,"span"),a(28),I(29,"date"),i()(),n(30,"div",44)(31,"label"),a(32,"Message:"),i(),n(33,"div",45),a(34),i()()(),n(35,"div",46)(36,"a",47),a(37," \u2709\uFE0F Reply via Email "),i(),n(38,"button",48),m("click",function(){_(e);let t=g();return f(t.selectedMessage.set(null))}),a(39,"Close"),i()()()()}if(l&2){let e,o,t,s,c,y,k,h,u=g();r(12),d((e=u.selectedMessage())==null?null:e.name),r(4),P("href","mailto:"+((o=u.selectedMessage())==null?null:o.email),v),r(),d((t=u.selectedMessage())==null?null:t.email),r(),M((s=u.selectedMessage())!=null&&s.phone?18:-1),r(5),d((c=u.selectedMessage())==null?null:c.subject),r(5),d(L(29,8,(y=u.selectedMessage())==null?null:y.createdAt,"medium")),r(6),d((k=u.selectedMessage())==null?null:k.message),r(2),P("href","mailto:"+((h=u.selectedMessage())==null?null:h.email)+"?subject=Re: "+((h=u.selectedMessage())==null?null:h.subject),v)}}var ge=(()=>{class l{dashboardService=w(q);toastr=w(N);messages=x([]);filteredMessages=x([]);loading=x(!0);selectedMessage=x(null);activeFilter=x("all");searchQuery="";ngOnInit(){this.loadMessages()}loadMessages(){this.loading.set(!0);let e=this.activeFilter()==="all"?void 0:this.activeFilter()==="read";this.dashboardService.getContactMessages(1,100,e).subscribe({next:o=>{if(o.isSuccess&&o.data){let t=o.data.map(s=>({id:s.id,name:s.name,email:s.email,phone:s.phone,subject:s.subject,message:s.message,isRead:s.isRead,createdAt:new Date(s.createdAt)}));this.messages.set(t),this.filterMessages()}this.loading.set(!1)},error:()=>{this.toastr.error("Failed to load messages"),this.loading.set(!1)}})}filterMessages(){let e=this.messages();if(this.searchQuery){let o=this.searchQuery.toLowerCase();e=e.filter(t=>t.name.toLowerCase().includes(o)||t.email.toLowerCase().includes(o)||t.subject.toLowerCase().includes(o)||t.message.toLowerCase().includes(o))}this.filteredMessages.set(e)}totalMessages(){return this.messages().length}unreadCount(){return this.messages().filter(e=>!e.isRead).length}viewMessage(e){this.selectedMessage.set(e),e.isRead||this.markAsRead(e)}markAsRead(e,o){o?.stopPropagation(),this.dashboardService.markMessageAsRead(e.id).subscribe({next:t=>{t.isSuccess&&(e.isRead=!0,this.toastr.success("Marked as read"),this.filterMessages())},error:()=>{this.toastr.error("Failed to update message")}})}deleteMessage(e,o){o.stopPropagation(),confirm("Are you sure you want to delete this message?")&&this.dashboardService.deleteContactMessage(e.id).subscribe({next:t=>{t.isSuccess&&(this.messages.update(s=>s.filter(c=>c.id!==e.id)),this.filterMessages(),this.toastr.success("Message deleted"))},error:()=>{this.toastr.error("Failed to delete message")}})}formatDate(e){let t=new Date().getTime()-new Date(e).getTime(),s=Math.floor(t/(1e3*60*60*24));return s===0?"Today":s===1?"Yesterday":s<7?`${s} days ago`:new Date(e).toLocaleDateString()}static \u0275fac=function(o){return new(o||l)};static \u0275cmp=S({type:l,selectors:[["app-admin-messages"]],standalone:!0,features:[V],decls:34,vars:11,consts:[[1,"messages-page"],[1,"page-header"],[1,"header-left"],[1,"subtitle"],[1,"header-stats"],[1,"stat"],[1,"stat-value"],[1,"stat-label"],[1,"stat","unread"],[1,"filters-bar"],[1,"filter-tabs"],[1,"filter-tab",3,"click"],[1,"search-box"],[1,"search-icon"],["type","text","placeholder","Search messages...",3,"ngModelChange","ngModel"],[1,"loading-state"],[1,"empty-state"],[1,"messages-list"],[1,"modal-overlay"],[1,"spinner"],[1,"empty-icon"],[1,"message-card",3,"unread"],[1,"message-card",3,"click"],[1,"message-header"],[1,"sender-info"],[1,"sender-avatar"],[1,"sender-details"],[1,"email"],[1,"message-meta"],[1,"date"],[1,"unread-badge"],[1,"message-subject"],[1,"message-preview"],[1,"message-actions"],["title","Mark as read",1,"action-btn"],["title","Delete",1,"action-btn","danger",3,"click"],["title","Mark as read",1,"action-btn",3,"click"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],[1,"modal-body"],[1,"detail-row"],[3,"href"],[1,"detail-row","full"],[1,"message-body"],[1,"modal-footer"],[1,"reply-btn",3,"href"],[1,"close-modal-btn",3,"click"]],template:function(o,t){o&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),a(4,"Contact Messages"),i(),n(5,"p",3),a(6,"Manage messages from the contact form"),i()(),n(7,"div",4)(8,"div",5)(9,"span",6),a(10),i(),n(11,"span",7),a(12,"Total"),i()(),n(13,"div",8)(14,"span",6),a(15),i(),n(16,"span",7),a(17,"Unread"),i()()()(),n(18,"div",9)(19,"div",10)(20,"button",11),m("click",function(){return t.activeFilter.set("all"),t.loadMessages()}),a(21," All Messages "),i(),n(22,"button",11),m("click",function(){return t.activeFilter.set("unread"),t.loadMessages()}),a(23," Unread "),i(),n(24,"button",11),m("click",function(){return t.activeFilter.set("read"),t.loadMessages()}),a(25," Read "),i()(),n(26,"div",12)(27,"span",13),a(28,"\u{1F50D}"),i(),n(29,"input",14),R("ngModelChange",function(c){return j(t.searchQuery,c)||(t.searchQuery=c),c}),m("ngModelChange",function(){return t.filterMessages()}),i()()(),C(30,H,4,0,"div",15)(31,J,7,0,"div",16)(32,ee,3,0,"div",17)(33,ne,40,11,"div",18),i()),o&2&&(r(10),d(t.totalMessages()),r(5),d(t.unreadCount()),r(5),b("active",t.activeFilter()==="all"),r(2),b("active",t.activeFilter()==="unread"),r(2),b("active",t.activeFilter()==="read"),r(5),z("ngModel",t.searchQuery),r(),M(t.loading()?30:t.filteredMessages().length===0?31:32),r(3),M(t.selectedMessage()?33:-1))},dependencies:[U,Q,Y,$,W,B],styles:[".messages-page[_ngcontent-%COMP%]{padding:24px;max-width:1200px;margin:0 auto}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:24px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;color:#1f2937;margin:0 0 4px}.subtitle[_ngcontent-%COMP%]{color:#6b7280;margin:0}.header-stats[_ngcontent-%COMP%]{display:flex;gap:24px}.stat[_ngcontent-%COMP%]{text-align:center;padding:12px 24px;background:#f9fafb;border-radius:12px}.stat.unread[_ngcontent-%COMP%]{background:#fef2f2}.stat-value[_ngcontent-%COMP%]{display:block;font-size:1.5rem;font-weight:700;color:#247090}.stat.unread[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#dc2626}.stat-label[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280}.filters-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:16px;margin-bottom:24px;flex-wrap:wrap}.filter-tabs[_ngcontent-%COMP%]{display:flex;gap:8px}.filter-tab[_ngcontent-%COMP%]{padding:8px 16px;border:none;background:#f3f4f6;border-radius:8px;font-size:.875rem;font-weight:500;cursor:pointer;transition:all .2s}.filter-tab[_ngcontent-%COMP%]:hover{background:#e5e7eb}.filter-tab.active[_ngcontent-%COMP%]{background:#247090;color:#fff}.search-box[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;background:#fff;border:1px solid #e5e7eb;border-radius:8px;min-width:250px}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;outline:none;flex:1;font-size:.875rem}.loading-state[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;background:#fff;border-radius:12px;box-shadow:0 1px 3px #0000001a}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid #e5e7eb;border-top-color:#247090;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 16px}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.empty-icon[_ngcontent-%COMP%]{font-size:3rem;display:block;margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;color:#1f2937}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6b7280;margin:0}.messages-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.message-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;box-shadow:0 1px 3px #0000001a;cursor:pointer;transition:all .2s;border-left:4px solid transparent}.message-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #00000026;transform:translateY(-2px)}.message-card.unread[_ngcontent-%COMP%]{border-left-color:#247090;background:#f0f9ff}.message-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px}.sender-info[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.sender-avatar[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;background:#e5e7eb;display:flex;align-items:center;justify-content:center;font-size:1.25rem;font-weight:600;color:#6b7280}.sender-avatar.unread[_ngcontent-%COMP%]{background:#247090;color:#fff}.sender-details[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 4px;font-size:1rem;color:#1f2937}.email[_ngcontent-%COMP%]{color:#6b7280;font-size:.875rem}.message-meta[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:4px}.date[_ngcontent-%COMP%]{color:#9ca3af;font-size:.75rem}.unread-badge[_ngcontent-%COMP%]{background:#dc2626;color:#fff;padding:2px 8px;border-radius:10px;font-size:.7rem;font-weight:600}.message-subject[_ngcontent-%COMP%]{margin-bottom:8px;color:#1f2937}.message-preview[_ngcontent-%COMP%]{color:#6b7280;font-size:.875rem;line-height:1.5;margin-bottom:16px}.message-actions[_ngcontent-%COMP%]{display:flex;gap:8px;border-top:1px solid #f3f4f6;padding-top:12px}.action-btn[_ngcontent-%COMP%]{padding:6px 12px;border:1px solid #e5e7eb;background:#fff;border-radius:6px;font-size:.8rem;cursor:pointer;transition:all .2s}.action-btn[_ngcontent-%COMP%]:hover{background:#f9fafb}.action-btn.danger[_ngcontent-%COMP%]:hover{background:#fef2f2;border-color:#fecaca;color:#dc2626}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;padding:20px}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:16px;max-width:600px;width:100%;max-height:90vh;overflow:auto}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px 24px;border-bottom:1px solid #e5e7eb}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.25rem}.close-btn[_ngcontent-%COMP%]{width:32px;height:32px;border:none;background:#f3f4f6;border-radius:50%;cursor:pointer;font-size:1rem}.close-btn[_ngcontent-%COMP%]:hover{background:#e5e7eb}.modal-body[_ngcontent-%COMP%]{padding:24px}.detail-row[_ngcontent-%COMP%]{display:flex;gap:12px;margin-bottom:16px}.detail-row[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#6b7280;min-width:80px}.detail-row[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#247090;text-decoration:none}.detail-row[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.detail-row.full[_ngcontent-%COMP%]{flex-direction:column}.message-body[_ngcontent-%COMP%]{margin-top:8px;padding:16px;background:#f9fafb;border-radius:8px;line-height:1.6;white-space:pre-wrap}.modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;padding:16px 24px;border-top:1px solid #e5e7eb}.reply-btn[_ngcontent-%COMP%]{padding:10px 20px;background:#247090;color:#fff;border:none;border-radius:8px;text-decoration:none;font-weight:500;cursor:pointer}.reply-btn[_ngcontent-%COMP%]:hover{background:#1a5570}.close-modal-btn[_ngcontent-%COMP%]{padding:10px 20px;background:#f3f4f6;border:none;border-radius:8px;cursor:pointer}.close-modal-btn[_ngcontent-%COMP%]:hover{background:#e5e7eb}"]})}return l})();export{ge as AdminMessagesComponent};
