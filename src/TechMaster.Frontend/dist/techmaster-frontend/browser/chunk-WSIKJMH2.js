import{a as d}from"./chunk-JLLNXAHD.js";import{a as o,d as p}from"./chunk-L2ZR2CCC.js";import{Q as u,W as g,a as n,b as l,n as a,r as c,z as r}from"./chunk-Q5RFH5SI.js";function f(i){return l(n({},i),{issueDate:i.issuedAt,grade:i.finalScore?`${i.finalScore}%`:void 0,completionPercentage:i.finalScore||100})}var C=(()=>{class i{http=g(p);API_URL=`${d.apiUrl}/certificates`;getMyCertificates(){return this.http.get(`${this.API_URL}/my-certificates`).pipe(c(e=>e.isSuccess?(e.data||[]).map(f):[]),r(()=>a([])))}getCertificate(e){return this.http.get(`${this.API_URL}/${e}`).pipe(c(t=>t.isSuccess?f(t.data):null),r(()=>a(null)))}verifyCertificate(e){return this.http.get(`${this.API_URL}/verify/${e}`).pipe(c(t=>({isValid:t.isSuccess&&t.data?.isValid,certificate:t.data?.certificate?f(t.data.certificate):void 0,message:t.data?.message||t.message||"Certificate verification completed",messageAr:t.data?.messageAr||t.messageAr})),r(()=>a({isValid:!1,message:"Failed to verify certificate",messageAr:"\u0641\u0634\u0644 \u0627\u0644\u062A\u062D\u0642\u0642 \u0645\u0646 \u0627\u0644\u0634\u0647\u0627\u062F\u0629"})))}generateCertificate(e){return this.http.post(`${this.API_URL}/generate/${e}`,{}).pipe(c(t=>t.isSuccess?f(t.data):null),r(()=>a(null)))}invalidateCertificate(e,t){return this.http.post(`${this.API_URL}/${e}/invalidate`,{reason:t}).pipe(c(s=>s.isSuccess),r(()=>a(!1)))}getAllCertificates(e){let t=new o;return e?.pageNumber&&(t=t.set("pageNumber",e.pageNumber.toString())),e?.pageSize&&(t=t.set("pageSize",e.pageSize.toString())),e?.search&&(t=t.set("search",e.search)),e?.isValid!==void 0&&(t=t.set("isValid",e.isValid.toString())),this.http.get(this.API_URL,{params:t}).pipe(c(s=>s.isSuccess&&s.data?l(n({},s.data),{items:(s.data.items||[]).map(f)}):{items:[],totalCount:0,pageNumber:1,pageSize:10,totalPages:0}),r(()=>a({items:[],totalCount:0,pageNumber:1,pageSize:10,totalPages:0})))}downloadCertificate(e){return this.http.get(`${this.API_URL}/${e}/download`,{responseType:"blob"}).pipe(r(()=>a(null)))}static \u0275fac=function(t){return new(t||i)};static \u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();export{C as a};
