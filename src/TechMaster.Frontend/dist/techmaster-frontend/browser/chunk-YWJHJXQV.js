import{a as $}from"./chunk-ZAODAAZN.js";import{a as F}from"./chunk-UYI4POZX.js";import{a as X}from"./chunk-JLLNXAHD.js";import{d as j}from"./chunk-SAC5YDHM.js";import"./chunk-AJDLSE77.js";import{d as A}from"./chunk-L2ZR2CCC.js";import{$a as C,Ab as a,Bb as m,Cb as c,Ja as h,Jb as L,Mb as k,Na as r,Nb as U,Ob as D,Q as S,W as f,Wa as b,Y as E,cb as P,eb as M,gb as x,ic as R,jb as w,jc as T,kb as I,lb as t,mb as n,mc as z,n as s,nb as v,r as p,sb as y,tb as u,z as g}from"./chunk-Q5RFH5SI.js";var N=(()=>{class i{http=f(A);API_URL=`${X.apiUrl}/gamification`;getMyProgress(){return this.http.get(`${this.API_URL}/my-progress`).pipe(p(e=>e.isSuccess?e.data:null),g(()=>s(null)))}getMyBadges(){return this.http.get(`${this.API_URL}/my-badges`).pipe(p(e=>e.isSuccess?e.data:[]),g(()=>s([])))}getAllBadges(){return this.http.get(`${this.API_URL}/badges`).pipe(p(e=>e.isSuccess?e.data:[]),g(()=>s([])))}createBadge(e){return this.http.post(`${this.API_URL}/badges`,e).pipe(p(l=>l.isSuccess?l.data:null),g(()=>s(null)))}awardXp(e,l,o){return this.http.post(`${this.API_URL}/users/${e}/xp`,{points:l,reason:o}).pipe(p(_=>_.isSuccess),g(()=>s(!1)))}getLeaderboard(e=100,l="all"){return this.http.get(`${this.API_URL}/leaderboard`,{params:{count:e.toString(),period:l}}).pipe(p(o=>o.isSuccess?o.data:null),g(()=>s(null)))}getMyRank(){return this.http.get(`${this.API_URL}/my-rank`).pipe(p(e=>e.isSuccess?e.data:null),g(()=>s(null)))}static \u0275fac=function(l){return new(l||i)};static \u0275prov=S({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var Y=(i,d)=>d.userId;function G(i,d){if(i&1&&(t(0,"div",23)(1,"span",24),a(2),n(),t(3,"span",25),a(4,"To Next Rank"),n()()),i&2){let e=u(2);r(2),c("",e.myRank().xpToNextRank," XP")}}function H(i,d){if(i&1&&(t(0,"div",5)(1,"div",18)(2,"div",19)(3,"span",20),a(4),n()(),t(5,"div",21)(6,"h3"),a(7,"Your Ranking"),n(),t(8,"p"),a(9),n()()(),t(10,"div",22)(11,"div",23)(12,"span",24),a(13),n(),t(14,"span",25),a(15,"Total XP"),n()(),t(16,"div",23)(17,"span",24),a(18),n(),t(19,"span",25),a(20,"Current Level"),n()(),C(21,G,5,1,"div",23),n()()),i&2){let e=u();r(4),c("#",e.myRank().rank,""),r(5),c("Out of ",e.myRank().totalParticipants," learners"),r(4),m(e.myRank().totalXp),r(5),c("Level ",e.myRank().level,""),r(3),x(e.myRank().xpToNextRank>0?21:-1)}}function W(i,d){if(i&1&&(t(0,"div",6)(1,"div",26)(2,"div",27),v(3,"img",28),t(4,"span",29),a(5,"\u{1F948}"),n()(),t(6,"h4"),a(7),n(),t(8,"p"),a(9),n()(),t(10,"div",30)(11,"div",27),v(12,"img",28),t(13,"span",29),a(14,"\u{1F947}"),n()(),t(15,"h4"),a(16),n(),t(17,"p"),a(18),n()(),t(19,"div",31)(20,"div",27),v(21,"img",28),t(22,"span",29),a(23,"\u{1F949}"),n()(),t(24,"h4"),a(25),n(),t(26,"p"),a(27),n()()()),i&2){let e=u();r(3),P("src",e.mediaService.getAvatarUrl(e.leaderboard().topUsers[1].profileImageUrl),h),r(4),m(e.leaderboard().topUsers[1].userName),r(2),c("",e.leaderboard().topUsers[1].totalXp," XP"),r(3),P("src",e.mediaService.getAvatarUrl(e.leaderboard().topUsers[0].profileImageUrl),h),r(4),m(e.leaderboard().topUsers[0].userName),r(2),c("",e.leaderboard().topUsers[0].totalXp," XP"),r(3),P("src",e.mediaService.getAvatarUrl(e.leaderboard().topUsers[2].profileImageUrl),h),r(4),m(e.leaderboard().topUsers[2].userName),r(2),c("",e.leaderboard().topUsers[2].totalXp," XP")}}function q(i,d){i&1&&(t(0,"div",15),v(1,"div",32),t(2,"p"),a(3,"Loading leaderboard..."),n()())}function J(i,d){i&1&&(t(0,"span",35),a(1,"\u{1F947}"),n())}function K(i,d){i&1&&(t(0,"span",36),a(1,"\u{1F948}"),n())}function Q(i,d){i&1&&(t(0,"span",37),a(1,"\u{1F949}"),n())}function V(i,d){if(i&1&&(t(0,"span",38),a(1),n()),i&2){let e=u().$implicit;r(),c("#",e.rank,"")}}function Z(i,d){if(i&1&&(t(0,"div",34)(1,"span",9),C(2,J,2,0,"span",35)(3,K,2,0,"span",36)(4,Q,2,0,"span",37)(5,V,2,1,"span",38),n(),t(6,"span",10),v(7,"img",39),t(8,"span",40),a(9),n()(),t(10,"span",11)(11,"span",41),a(12),n()(),t(13,"span",12)(14,"span",42),a(15),k(16,"number"),n()(),t(17,"span",13)(18,"span",43),a(19),n()(),t(20,"span",14)(21,"span",44),a(22),n()()()),i&2){let e=d.$implicit,l=u(2);M("highlight",e.userId===l.currentUserId()),r(2),x(e.rank===1?2:e.rank===2?3:e.rank===3?4:5),r(5),P("src",l.mediaService.getAvatarUrl(e.profileImageUrl),h),r(2),m(e.userName),r(3),c("Lvl ",e.level,""),r(3),m(U(16,9,e.totalXp)),r(4),c("\u{1F3C5} ",e.badgeCount,""),r(3),c("\u{1F4DA} ",e.completedCourses,"")}}function ee(i,d){if(i&1&&w(0,Z,23,11,"div",33,Y),i&2){let e=u();I(e.leaderboard().topUsers)}}function te(i,d){i&1&&(t(0,"div",16)(1,"span",45),a(2,"\u{1F3C6}"),n(),t(3,"h3"),a(4,"No rankings yet"),n(),t(5,"p"),a(6,"Start learning to appear on the leaderboard!"),n(),t(7,"a",46),a(8,"Browse Courses"),n()())}function ne(i,d){if(i&1&&(t(0,"div",17)(1,"p"),a(2,"Total Participants: "),t(3,"strong"),a(4),n()(),t(5,"p"),a(6,"Last Updated: "),t(7,"strong"),a(8),k(9,"date"),n()()()),i&2){let e=u();r(4),m(e.leaderboard().totalParticipants),r(4),m(D(9,2,e.leaderboard().generatedAt,"medium"))}}var fe=(()=>{class i{gamificationService=f(N);authService=f($);mediaService=f(F);leaderboard=b(null);myRank=b(null);loading=b(!0);selectedPeriod=b("all");currentUserId=b(null);ngOnInit(){let e=this.authService.getCurrentUser();e&&(this.currentUserId.set(e.id),this.loadMyRank()),this.loadLeaderboard()}loadLeaderboard(){this.loading.set(!0),this.gamificationService.getLeaderboard(100,this.selectedPeriod()).subscribe({next:e=>{this.leaderboard.set(e),this.loading.set(!1)},error:()=>{this.loading.set(!1)}})}loadMyRank(){this.gamificationService.getMyRank().subscribe({next:e=>{this.myRank.set(e)}})}changePeriod(e){this.selectedPeriod.set(e),this.loadLeaderboard()}static \u0275fac=function(l){return new(l||i)};static \u0275cmp=E({type:i,selectors:[["app-leaderboard"]],standalone:!0,features:[L],decls:34,vars:10,consts:[[1,"leaderboard-page"],[1,"page-header"],[1,"header-content"],[1,"period-selector"],[1,"period-btn",3,"click"],[1,"my-rank-card"],[1,"podium"],[1,"leaderboard-table"],[1,"table-header"],[1,"rank-col"],[1,"user-col"],[1,"level-col"],[1,"xp-col"],[1,"badges-col"],[1,"courses-col"],[1,"loading-state"],[1,"empty-state"],[1,"stats-footer"],[1,"rank-info"],[1,"rank-badge"],[1,"rank-number"],[1,"rank-details"],[1,"rank-stats"],[1,"stat"],[1,"value"],[1,"label"],[1,"podium-item","second"],[1,"avatar"],["alt","",3,"src"],[1,"medal"],[1,"podium-item","first"],[1,"podium-item","third"],[1,"spinner"],[1,"table-row",3,"highlight"],[1,"table-row"],[1,"top-rank","gold"],[1,"top-rank","silver"],[1,"top-rank","bronze"],[1,"rank-num"],["alt","",1,"user-avatar",3,"src"],[1,"user-name"],[1,"level-badge"],[1,"xp-value"],[1,"badge-count"],[1,"course-count"],[1,"icon"],["routerLink","/courses",1,"btn","btn-primary"]],template:function(l,o){if(l&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),a(4,"\u{1F3C6} Leaderboard"),n(),t(5,"p"),a(6,"See how you rank against other learners"),n()(),t(7,"div",3)(8,"button",4),y("click",function(){return o.changePeriod("all")}),a(9,"All Time"),n(),t(10,"button",4),y("click",function(){return o.changePeriod("monthly")}),a(11,"This Month"),n(),t(12,"button",4),y("click",function(){return o.changePeriod("weekly")}),a(13,"This Week"),n()()(),C(14,H,22,5,"div",5)(15,W,28,9,"div",6),t(16,"div",7)(17,"div",8)(18,"span",9),a(19,"Rank"),n(),t(20,"span",10),a(21,"Learner"),n(),t(22,"span",11),a(23,"Level"),n(),t(24,"span",12),a(25,"XP Points"),n(),t(26,"span",13),a(27,"Badges"),n(),t(28,"span",14),a(29,"Courses"),n()(),C(30,q,4,0,"div",15)(31,ee,2,0)(32,te,9,0,"div",16),n(),C(33,ne,10,5,"div",17),n()),l&2){let _,O;r(8),M("active",o.selectedPeriod()==="all"),r(2),M("active",o.selectedPeriod()==="monthly"),r(2),M("active",o.selectedPeriod()==="weekly"),r(2),x(o.myRank()?14:-1),r(),x((_=o.leaderboard())!=null&&_.topUsers&&o.leaderboard().topUsers.length>=3?15:-1),r(15),x(o.loading()?30:(O=o.leaderboard())!=null&&O.topUsers&&o.leaderboard().topUsers.length>0?31:32),r(3),x(o.leaderboard()?33:-1)}},dependencies:[z,T,R,j],styles:[".leaderboard-page[_ngcontent-%COMP%]{padding:2rem;max-width:1200px;margin:0 auto}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;flex-wrap:wrap;gap:1rem}.header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:var(--color-dark);margin-bottom:.25rem}.header-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--color-gray-600)}.period-selector[_ngcontent-%COMP%]{display:flex;gap:.5rem;background:var(--color-gray-100);padding:.25rem;border-radius:8px}.period-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;background:transparent;border-radius:6px;font-weight:500;cursor:pointer;transition:all .2s}.period-btn.active[_ngcontent-%COMP%]{background:var(--color-primary);color:#fff}.my-rank-card[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1.5rem 2rem;background:linear-gradient(135deg,var(--color-primary) 0%,#1a5570 100%);border-radius:16px;color:#fff;margin-bottom:2rem}.rank-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.rank-badge[_ngcontent-%COMP%]{width:60px;height:60px;background:#fff3;border-radius:50%;display:flex;align-items:center;justify-content:center}.rank-number[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700}.rank-details[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;margin-bottom:.25rem}.rank-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{opacity:.8}.rank-stats[_ngcontent-%COMP%]{display:flex;gap:2rem}.rank-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{text-align:center}.rank-stats[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:block;font-size:1.25rem;font-weight:700}.rank-stats[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.8rem;opacity:.8}.podium[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:flex-end;gap:1rem;margin-bottom:2rem;padding:2rem}.podium-item[_ngcontent-%COMP%]{text-align:center;padding:1.5rem;background:#fff;border-radius:16px;box-shadow:0 4px 15px #0000001a;transition:transform .3s}.podium-item[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.podium-item.first[_ngcontent-%COMP%]{padding-bottom:3rem;transform:scale(1.1)}.podium-item[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{position:relative;margin-bottom:1rem}.podium-item[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;object-fit:cover;border:3px solid var(--color-gray-200)}.podium-item.first[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100px;height:100px;border-color:gold}.podium-item[_ngcontent-%COMP%]   .medal[_ngcontent-%COMP%]{position:absolute;bottom:-10px;right:-5px;font-size:2rem}.podium-item[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-weight:600;margin-bottom:.25rem}.podium-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--color-gray-600);font-size:.9rem}.leaderboard-table[_ngcontent-%COMP%]{background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 4px 15px #0000000d}.table-header[_ngcontent-%COMP%], .table-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:80px 1fr 100px 120px 100px 100px;align-items:center;padding:1rem 1.5rem}.table-header[_ngcontent-%COMP%]{background:var(--color-gray-50);font-weight:600;color:var(--color-gray-600);font-size:.85rem;text-transform:uppercase}.table-row[_ngcontent-%COMP%]{border-bottom:1px solid var(--color-gray-100);transition:background .2s}.table-row[_ngcontent-%COMP%]:hover{background:var(--color-gray-50)}.table-row.highlight[_ngcontent-%COMP%]{background:#2470901a;border-left:3px solid var(--color-primary)}.rank-col[_ngcontent-%COMP%]{text-align:center}.top-rank[_ngcontent-%COMP%]{font-size:1.5rem}.rank-num[_ngcontent-%COMP%]{font-weight:600;color:var(--color-gray-600)}.user-col[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.user-avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;object-fit:cover}.user-name[_ngcontent-%COMP%]{font-weight:500}.level-badge[_ngcontent-%COMP%]{display:inline-block;padding:.25rem .75rem;background:var(--color-primary);color:#fff;border-radius:20px;font-size:.8rem;font-weight:500}.xp-value[_ngcontent-%COMP%]{font-weight:600;color:var(--color-primary)}.badge-count[_ngcontent-%COMP%], .course-count[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem;color:var(--color-gray-600)}.loading-state[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid var(--color-gray-200);border-top-color:var(--color-primary);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin:0 auto 1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.empty-state[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:4rem;display:block;margin-bottom:1rem}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.25rem;margin-bottom:.5rem}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--color-gray-500);margin-bottom:1rem}.btn-primary[_ngcontent-%COMP%]{display:inline-block;padding:.75rem 1.5rem;background:var(--color-primary);color:#fff;border-radius:8px;text-decoration:none;font-weight:600}.stats-footer[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:2rem;margin-top:1.5rem;padding:1rem;color:var(--color-gray-500);font-size:.9rem}@media (max-width: 768px){.leaderboard-page[_ngcontent-%COMP%]{padding:1rem}.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.my-rank-card[_ngcontent-%COMP%]{flex-direction:column;gap:1.5rem;text-align:center}.rank-stats[_ngcontent-%COMP%]{width:100%;justify-content:space-around}.podium[_ngcontent-%COMP%]{flex-direction:column;align-items:center}.podium-item.first[_ngcontent-%COMP%]{transform:none;order:-1}.table-header[_ngcontent-%COMP%], .table-row[_ngcontent-%COMP%]{grid-template-columns:60px 1fr 80px}.level-col[_ngcontent-%COMP%], .badges-col[_ngcontent-%COMP%], .courses-col[_ngcontent-%COMP%]{display:none}}"]})}return i})();export{fe as LeaderboardComponent};
